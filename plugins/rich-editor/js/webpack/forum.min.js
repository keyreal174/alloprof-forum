(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{133:function(e,n,t){t(24),e.exports=t(141)},141:function(e,n,t){"use strict";t.r(n);var r=t(25),u=t(32),o=function(){function e(){this.MAX_PARTIAL_LOOKUP_ITERATIONS=10,this.root={}}return e.prototype.insert=function(e,n){for(var t=this.root,r=0;r<e.length;r++){var u=e[r];if(t.children||(t.children={}),!(u in t.children)){var o=r!==e.length-1?{}:{children:{}};t.children[u]=o}t=t.children[u]}t.value=n},e.prototype.getNode=function(e){var n=this.root;if(void 0===e)return n;for(var t=0;t<e.length;t++){var r=e.charAt(t);if(!n.children||!n.children[r])return null;n=n.children[r]}return n},e.prototype.getValue=function(e){var n=this.getNode(e);return n&&n.value||null},e.prototype.getValueFromPartialsOfWord=function(e){for(var n=Math.min(this.MAX_PARTIAL_LOOKUP_ITERATIONS,e.length);n>0;n--){var t=e.substring(0,n),r=this.getValue(t);if(null!=r)return r}return null},e}(),s=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var u in n=arguments[t])Object.prototype.hasOwnProperty.call(n,u)&&(e[u]=n[u]);return e},i={lastSuccessfulUsername:null,currentUsername:null,usersTrie:new o,activeSuggestionID:"",activeSuggestionIndex:0};var a=t(33),c=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var u in n=arguments[t])Object.prototype.hasOwnProperty.call(n,u)&&(e[u]=n[u]);return e},l={index:0,length:0},d={},f={currentSelection:l,lastGoodSelection:l};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */function h(e,n){var t=e[n.payload.editorID];if(n.type===a.a&&t)throw new Error("Failed to create editor instance with id "+n.payload.editorID+". Id already exists");if(n.type!==a.a&&!t)throw new Error("Could not perform an action for editor ID "+n.payload.editorID+" that doesn't exist. Be sure to create an instance first.")}var v=t(14),g=Object(v.c)({mentions:function(e,n){switch(void 0===e&&(e=i),n.type){case u.b:var t=n.payload.username;e.usersTrie.insert(t,{status:"PENDING"});var r=!1,o=e.lastSuccessfulUsername;return null!=o&&t.length>o.length&&t.substring(0,o.length)===o&&(r=!0),s({},e,{currentUsername:t,lastSuccessfulUsername:r?e.lastSuccessfulUsername:null});case u.a:var a=n.payload,c=(t=a.username,a.error);return e.usersTrie.insert(t,{status:"FAILED",users:null,error:c}),e;case u.c:var l=n.payload,d=(t=l.username,l.users);e.usersTrie.insert(t,{status:"SUCCESSFUL",users:function(e,n){var t=Intl.Collator("en",{usage:"sort",sensitivity:"variant",ignorePunctuation:!0,numeric:!0});return e.sort(function(e,r){return e.name.includes(n)&&!r.name.includes(n)?-1:r.name.includes(n)&&!e.name.includes(n)?1:t.compare(e.name,r.name)})}(d,t)});var f=d.length>0?d[0].domID:"";return s({},e,{activeSuggestionID:f,activeSuggestionIndex:0,lastSuccessfulUsername:t,currentUsername:t===e.currentUsername?null:e.currentUsername});case u.d:var h=n.payload,v=h.suggestionID,g=h.suggestionIndex;return s({},e,{activeSuggestionID:v,activeSuggestionIndex:g});default:return e}},instances:function(e,n){var t,r;switch(void 0===e&&(e=d),n.type){case a.a:return h(e,n),c({},e,((t={})[n.payload.editorID]=f,t));case a.b:h(e,n);var u=n.payload,o=u.selection,s=u.editorID,i=e[s],l=i.lastGoodSelection;return c({},e,((r={})[s]=c({},i,{currentSelection:o,lastGoodSelection:null!==o?o:l}),r));default:return e}}}),m=t(1),p=function(e,n,t,r){return new(t||(t=Promise))(function(u,o){function s(e){try{a(r.next(e))}catch(e){o(e)}}function i(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){e.done?u(e.value):new t(function(n){n(e.value)}).then(s,i)}a((r=r.apply(e,n||[])).next())})},b=function(e,n){var t,r,u,o,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(u=2&o[0]?r.return:o[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,o[1])).done)return u;switch(r=0,u&&(o=[2&o[0],u.value]),o[0]){case 0:case 1:u=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(u=(u=s.trys).length>0&&u[u.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!u||o[1]>u[0]&&o[1]<u[3])){s.label=o[1];break}if(6===o[0]&&s.label<u[1]){s.label=u[1],u=o;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(o);break}u[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=u=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */Object(m.k)(function(){Object(r.b)("editor",g),function(){p(this,void 0,void 0,function(){var e,n;return b(this,function(r){switch(r.label){case 0:return(e=document.querySelectorAll(".richEditor")).length>0?[4,Promise.all([t.e(0),t.e(7)]).then(t.bind(null,404))]:[3,2];case 1:n=r.sent(),e.forEach(n.default),r.label=2;case 2:return[2]}})})}(),function(){p(this,void 0,void 0,function(){var e=this;return b(this,function(n){return document.addEventListener("X-EditCommentFormLoaded",function(n){return p(e,void 0,void 0,function(){var e,r;return b(this,function(u){switch(u.label){case 0:return(e=n.target)instanceof Element?(r=e.querySelector(".richEditor"))?[4,Promise.all([t.e(0),t.e(7)]).then(t.bind(null,404))]:[3,2]:[2];case 1:u.sent().default(r),u.label=2;case 2:return[2]}})})}),[2]})})}()})},24:function(e,n,t){
/**
 * Set wepback's public path.
 * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot
 * Eg. installed in a subfolder / using Reverse Proxy.
 *
 * @author Adam Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license http://www.opensource.org/licenses/gpl-2.0.php GNU GPL v2
 */
const r=window.gdn&&window.gdn.meta&&window.gdn.meta.WebRoot,u=null!=r?r:"/";t.p=u},32:function(e,n,t){"use strict";t.d(n,"d",function(){return o}),t.d(n,"b",function(){return s}),t.d(n,"a",function(){return i}),t.d(n,"c",function(){return a}),t.d(n,"e",function(){return l}),t.d(n,"f",function(){return d});var r=t(11),u=t(8),o="[mentions] set active suggestion",s="[mentions] load users request",i="[mentions] load users failure",a="[mentions] load users success",c=50;var l={loadUsersRequest:function(e){return Object(r.b)(s,{username:e})},loadUsersFailure:function(e,n){return Object(r.b)(i,{username:e,error:n})},loadUsersSuccess:function(e,n){return Object(r.b)(a,{username:e,users:n})},setActiveSuggestion:function(e,n){return Object(r.b)(o,{suggestionID:e,suggestionIndex:n})}},d={loadUsers:function(e){return function(n,t){var r=t().editor.mentions.usersTrie,o=r.getValue(e);if(null!=o)switch(o.status){case"SUCCESSFUL":return n(l.loadUsersSuccess(e,o.users));case"PENDING":return;case"FAILED":return n(l.loadUsersFailure(e,o.error))}var s=r.getValueFromPartialsOfWord(e);if(null!=s)switch(s.status){case"SUCCESSFUL":if(s.users.length<c)return n(l.loadUsersSuccess(e,function(e,n){var t=Intl.Collator("en",{usage:"search",sensitivity:"base",ignorePunctuation:!0,numeric:!0});return e.filter(function(e){if(e.name.length<n.length)return!1;var r=e.name.substring(0,n.length);return 0===t.compare(r,n)})}(s.users,e)))}n(l.loadUsersRequest(e));var i={name:e+"*",order:"mention",limit:c};return u.a.get("/users/by-names/",{params:i}).then(function(t){if(t.status>=500)throw new Error(t.data);var r=t.data.map(function(e){return e.domID="mentionSuggestion"+e.userID,e});n(l.loadUsersSuccess(e,r))}).catch(function(t){return n(l.loadUsersFailure(e,t))})}}}},33:function(e,n,t){"use strict";t.d(n,"a",function(){return u}),t.d(n,"b",function(){return o}),t.d(n,"c",function(){return s});var r=t(11),u="[instance] create",o="[instance] set selection",s={createInstance:function(e){return Object(r.b)(u,{editorID:e})},setSelection:function(e,n){return Object(r.b)(o,{editorID:e,selection:n})}};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */}},[[133,2,0,1]]]);
//# sourceMappingURL=forum.min.js.map