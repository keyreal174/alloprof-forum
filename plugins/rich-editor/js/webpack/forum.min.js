(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{110:function(t,e,n){"use strict";(function(t){var r=n(111),i=n(113),s=n(16);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var a=Object(s.c)({mentions:r.a,instances:i.a});const c=a;e.a=c,function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(a,"editorReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/editorReducer.ts"),e.register(c,"default","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/editorReducer.ts"),r(t))}()}).call(this,n(4)(t))},111:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var r=n(33),i=n(112);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},a={lastSuccessfulUsername:null,currentUsername:null,usersTrie:new i.a,activeSuggestionID:"",activeSuggestionIndex:0};function c(t,e){var n=Intl.Collator("en",{usage:"sort",sensitivity:"variant",ignorePunctuation:!0,numeric:!0});return t.sort(function(t,r){return t.name.includes(e)&&!r.name.includes(e)?-1:r.name.includes(e)&&!t.name.includes(e)?1:n.compare(t.name,r.name)})}function o(t,e){switch(void 0===t&&(t=a),e.type){case r.b:var n=e.payload.username;t.usersTrie.insert(n,{status:"PENDING"});var i=!1,o=t.lastSuccessfulUsername;if(null!=o&&n.length>o.length)n.substring(0,o.length)===o&&(i=!0);return s({},t,{currentUsername:n,lastSuccessfulUsername:i?t.lastSuccessfulUsername:null});case r.a:var u=e.payload,l=(n=u.username,u.error);return t.usersTrie.insert(n,{status:"FAILED",users:null,error:l}),t;case r.c:var d=e.payload,g=(n=d.username,d.users);t.usersTrie.insert(n,{status:"SUCCESSFUL",users:c(g,n)});var v=g.length>0?g[0].domID:"";return s({},t,{activeSuggestionID:v,activeSuggestionIndex:0,lastSuccessfulUsername:n,currentUsername:n===t.currentUsername?null:t.currentUsername});case r.d:var f=e.payload,p=f.suggestionID,h=f.suggestionIndex;return s({},t,{activeSuggestionID:p,activeSuggestionIndex:h});default:return t}}!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"__assign","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(a,"initialState","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(c,"sortSuggestions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(o,"mentionReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),r(t))}()}).call(this,n(4)(t))},112:function(t,e,n){"use strict";(function(t){!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var r=function(){function t(){this.MAX_PARTIAL_LOOKUP_ITERATIONS=10,this.root={}}return t.prototype.insert=function(t,e){for(var n=this.root,r=0;r<t.length;r++){var i=t[r];if(n.children||(n.children={}),!(i in n.children)){var s=r!==t.length-1?{}:{children:{}};n.children[i]=s}n=n.children[i]}n.value=e},t.prototype.getNode=function(t){var e=this.root;if(void 0===t)return e;for(var n=0;n<t.length;n++){var r=t.charAt(n);if(!e.children||!e.children[r])return null;e=e.children[r]}return e},t.prototype.getValue=function(t){var e=this.getNode(t);return e&&e.value||null},t.prototype.getValueFromPartialsOfWord=function(t){for(var e=Math.min(this.MAX_PARTIAL_LOOKUP_ITERATIONS,t.length);e>0;e--){var n=t.substring(0,e),r=this.getValue(n);if(null!=r)return r}return null},t}();const i=r;e.a=i,function(){var e=n(1).default,s=n(1).leaveModule;e&&(e.register(r,"MentionTrie","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/MentionTrie.ts"),e.register(i,"default","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/MentionTrie.ts"),s(t))}()}).call(this,n(4)(t))},113:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return u});var r=n(34);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s={index:0,length:0},a={},c={currentSelection:s,lastGoodSelection:s};function o(t,e){var n=t[e.payload.editorID];if(e.type===r.a&&n)throw new Error("Failed to create editor instance with id "+e.payload.editorID+". Id already exists");if(e.type!==r.a&&!n)throw new Error("Could not perform an action for editor ID "+e.payload.editorID+" that doesn't exist. Be sure to create an instance first.")}function u(t,e){var n,s;switch(void 0===t&&(t=a),e.type){case r.a:return o(t,e),i({},t,((n={})[e.payload.editorID]=c,n));case r.b:o(t,e);var u=e.payload,l=u.selection,d=u.editorID,g=t[d],v=g.lastGoodSelection;return i({},t,((s={})[d]=i({},g,{currentSelection:l,lastGoodSelection:null!==l?l:v}),s));default:return t}}!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(i,"__assign","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(s,"defaultSelection","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(a,"initialState","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(c,"defaultInstance","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(o,"validateIDExistance","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(u,"instanceReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),r(t))}()}).call(this,n(4)(t))},164:function(t,e,n){n(31),t.exports=n(165)},165:function(t,e,n){"use strict";n.r(e),function(t){var e=n(25),r=n(110),i=n(2);function s(){var t=document.querySelectorAll(".richEditor");t.length>0&&Promise.all([n.e(0),n.e(6)]).then(n.bind(null,130)).then(function(e){return t.forEach(e.default)})}function a(){document.addEventListener("X-EditCommentFormLoaded",function(t){var e=t.target;if(e instanceof Element){var r=e.querySelector(".richEditor");r&&Promise.all([n.e(0),n.e(6)]).then(n.bind(null,130)).then(function(t){return t.default(r)})}})}!function(){var e=n(1).enterModule;e&&e(t)}(),
/*
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
Object(i.k)(function(){Object(e.b)("editor",r.a),s(),a()}),function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"setupEditor","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),e.register(a,"setupCommentEditForm","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),r(t))}()}.call(this,n(4)(t))},31:function(t,e,n){
/**
 * Set wepback's public path.
 * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot
 * Eg. installed in a subfolder / using Reverse Proxy.
 *
 * @author Adam Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license http://www.opensource.org/licenses/gpl-2.0.php GNU GPL v2
 */
const r=window.gdn&&window.gdn.meta&&window.gdn.meta.WebRoot,i=null!=r?r:"/";n.p=i},33:function(t,e,n){"use strict";(function(t){n.d(e,"d",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return g}),n.d(e,"f",function(){return v});var r=n(12),i=n(9);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var s="[mentions] set active suggestion",a="[mentions] load users request",c="[mentions] load users failure",o="[mentions] load users success",u=50;function l(t,e){var n=Intl.Collator("en",{usage:"search",sensitivity:"base",ignorePunctuation:!0,numeric:!0});return t.filter(function(t){if(t.name.length<e.length)return!1;var r=t.name.substring(0,e.length);return 0===n.compare(r,e)})}function d(t){return function(e,n){var r=n().editor.mentions.usersTrie,s=r.getValue(t);if(null!=s)switch(s.status){case"SUCCESSFUL":return e(g.loadUsersSuccess(t,s.users));case"PENDING":return;case"FAILED":return e(g.loadUsersFailure(t,s.error))}var a=r.getValueFromPartialsOfWord(t);if(null!=a)switch(a.status){case"SUCCESSFUL":if(a.users.length<u)return e(g.loadUsersSuccess(t,l(a.users,t)))}e(g.loadUsersRequest(t));var c={name:t+"*",order:"mention",limit:u};return i.a.get("/users/by-names/",{params:c}).then(function(n){if(n.status>=500)throw new Error(n.data);var r=n.data.map(function(t){return t.domID="mentionSuggestion"+t.userID,t});e(g.loadUsersSuccess(t,r))}).catch(function(n){return e(g.loadUsersFailure(t,n))})}}var g={loadUsersRequest:function(t){return Object(r.b)(a,{username:t})},loadUsersFailure:function(t,e){return Object(r.b)(c,{username:t,error:e})},loadUsersSuccess:function(t,e){return Object(r.b)(o,{username:t,users:e})},setActiveSuggestion:function(t,e){return Object(r.b)(s,{suggestionID:t,suggestionIndex:e})}},v={loadUsers:d};!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"SET_ACTIVE_SUGGESTION","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(a,"LOAD_USERS_REQUEST","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(c,"LOAD_USERS_FAILURE","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(o,"LOAD_USERS_SUCCESS","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(u,"USER_LIMIT","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(l,"filterSuggestions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(d,"loadUsers","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(g,"actions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(v,"thunks","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),r(t))}()}).call(this,n(4)(t))},34:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return a});var r=n(12);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var i="[instance] create",s="[instance] set selection",a={createInstance:function(t){return Object(r.b)(i,{editorID:t})},setSelection:function(t,e){return Object(r.b)(s,{editorID:t,selection:e})}};!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(i,"CREATE_INSTANCE","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),e.register(s,"SET_SELECTION","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),e.register(a,"actions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),r(t))}()}).call(this,n(4)(t))}},[[164,2,0,1]]]);
//# sourceMappingURL=forum.min.js.map