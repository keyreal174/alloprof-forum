(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{112:function(t,e,n){"use strict";(function(t){var r=n(113),i=n(115),s=n(17);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var a=Object(s.c)({mentions:r.a,instances:i.a});const c=a;e.a=c,function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(a,"editorReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/editorReducer.ts"),e.register(c,"default","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/editorReducer.ts"),r(t))}()}).call(this,n(3)(t))},113:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var r=n(37),i=n(114);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},a={lastSuccessfulUsername:null,currentUsername:null,usersTrie:new i.a,activeSuggestionID:"",activeSuggestionIndex:0};function c(t,e){var n=Intl.Collator("en",{usage:"sort",sensitivity:"variant",ignorePunctuation:!0,numeric:!0});return t.sort(function(t,r){return t.name.includes(e)&&!r.name.includes(e)?-1:r.name.includes(e)&&!t.name.includes(e)?1:n.compare(t.name,r.name)})}function o(t,e){switch(void 0===t&&(t=a),e.type){case r.b:var n=e.payload.username;t.usersTrie.insert(n,{status:"PENDING"});var i=!1,o=t.lastSuccessfulUsername;if(null!=o&&n.length>o.length)n.substring(0,o.length)===o&&(i=!0);return s({},t,{currentUsername:n,lastSuccessfulUsername:i?t.lastSuccessfulUsername:null});case r.a:var u=e.payload,l=(n=u.username,u.error);return t.usersTrie.insert(n,{status:"FAILED",users:null,error:l}),t;case r.c:var d=e.payload,g=(n=d.username,d.users);t.usersTrie.insert(n,{status:"SUCCESSFUL",users:c(g,n)});var v=g.length>0?g[0].domID:"";return s({},t,{activeSuggestionID:v,activeSuggestionIndex:0,lastSuccessfulUsername:n,currentUsername:n===t.currentUsername?null:t.currentUsername});case r.d:var f=e.payload,p=f.suggestionID,h=f.suggestionIndex;return s({},t,{activeSuggestionID:p,activeSuggestionIndex:h});default:return t}}!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"__assign","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(a,"initialState","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(c,"sortSuggestions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),e.register(o,"mentionReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionReducer.ts"),r(t))}()}).call(this,n(3)(t))},114:function(t,e,n){"use strict";(function(t){!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var r=function(){function t(){this.MAX_PARTIAL_LOOKUP_ITERATIONS=10,this.root={}}return t.prototype.insert=function(t,e){for(var n=this.root,r=0;r<t.length;r++){var i=t[r];if(n.children||(n.children={}),!(i in n.children)){var s=r!==t.length-1?{}:{children:{}};n.children[i]=s}n=n.children[i]}n.value=e},t.prototype.getNode=function(t){var e=this.root;if(void 0===t)return e;for(var n=0;n<t.length;n++){var r=t.charAt(n);if(!e.children||!e.children[r])return null;e=e.children[r]}return e},t.prototype.getValue=function(t){var e=this.getNode(t);return e&&e.value||null},t.prototype.getValueFromPartialsOfWord=function(t){for(var e=Math.min(this.MAX_PARTIAL_LOOKUP_ITERATIONS,t.length);e>0;e--){var n=t.substring(0,e),r=this.getValue(n);if(null!=r)return r}return null},t}();const i=r;e.a=i,function(){var e=n(1).default,s=n(1).leaveModule;e&&(e.register(r,"MentionTrie","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/MentionTrie.ts"),e.register(i,"default","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/MentionTrie.ts"),s(t))}()}).call(this,n(3)(t))},115:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return u});var r=n(38);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s={index:0,length:0},a={},c={currentSelection:s,lastGoodSelection:s};function o(t,e){var n=t[e.payload.editorID];if(e.type===r.a&&n)throw new Error("Failed to create editor instance with id "+e.payload.editorID+". Id already exists");if(e.type!==r.a&&!n)throw new Error("Could not perform an action for editor ID "+e.payload.editorID+" that doesn't exist. Be sure to create an instance first.")}function u(t,e){var n,s;switch(void 0===t&&(t=a),e.type){case r.a:return o(t,e),i({},t,((n={})[e.payload.editorID]=c,n));case r.b:o(t,e);var u=e.payload,l=u.selection,d=u.editorID,g=t[d],v=g.lastGoodSelection;return i({},t,((s={})[d]=i({},g,{currentSelection:l,lastGoodSelection:null!==l?l:v}),s));default:return t}}!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(i,"__assign","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(s,"defaultSelection","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(a,"initialState","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(c,"defaultInstance","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(o,"validateIDExistance","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),e.register(u,"instanceReducer","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceReducer.ts"),r(t))}()}).call(this,n(3)(t))},170:function(t,e,n){n(35),t.exports=n(171)},171:function(t,e,n){"use strict";n.r(e),function(t){var e=n(27),r=n(112),i=n(2);!function(){var e=n(1).enterModule;e&&e(t)}();
/*
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var s=function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function a(t){try{o(r.next(t))}catch(t){s(t)}}function c(t){try{o(r.throw(t))}catch(t){s(t)}}function o(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,c)}o((r=r.apply(t,e||[])).next())})},a=function(t,e){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function c(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(r){switch(r.label){case 0:return(t=document.querySelectorAll(".richEditor")).length>0?[4,Promise.all([n.e(0),n.e(6)]).then(n.bind(null,132))]:[3,2];case 1:e=r.sent(),t.forEach(e.default),r.label=2;case 2:return[2]}})})}function o(){return s(this,void 0,void 0,function(){var t=this;return a(this,function(e){return document.addEventListener("X-EditCommentFormLoaded",function(e){return s(t,void 0,void 0,function(){var t,r;return a(this,function(i){switch(i.label){case 0:return(t=e.target)instanceof Element?(r=t.querySelector(".richEditor"))?[4,Promise.all([n.e(0),n.e(6)]).then(n.bind(null,132))]:[3,2]:[2];case 1:i.sent().default(r),i.label=2;case 2:return[2]}})})}),[2]})})}Object(i.k)(function(){Object(e.b)("editor",r.a),c(),o()}),function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"__awaiter","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),e.register(a,"__generator","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),e.register(c,"setupEditor","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),e.register(o,"setupCommentEditForm","/git/srv/vanilla/plugins/rich-editor/src/scripts/entries/forum.ts"),r(t))}()}.call(this,n(3)(t))},35:function(t,e,n){
/**
 * Set wepback's public path.
 * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot
 * Eg. installed in a subfolder / using Reverse Proxy.
 *
 * @author Adam Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license http://www.opensource.org/licenses/gpl-2.0.php GNU GPL v2
 */
const r=window.gdn&&window.gdn.meta&&window.gdn.meta.WebRoot,i=null!=r?r:"/";n.p=i},37:function(t,e,n){"use strict";(function(t){n.d(e,"d",function(){return s}),n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return g}),n.d(e,"f",function(){return v});var r=n(13),i=n(10);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var s="[mentions] set active suggestion",a="[mentions] load users request",c="[mentions] load users failure",o="[mentions] load users success",u=50;function l(t,e){var n=Intl.Collator("en",{usage:"search",sensitivity:"base",ignorePunctuation:!0,numeric:!0});return t.filter(function(t){if(t.name.length<e.length)return!1;var r=t.name.substring(0,e.length);return 0===n.compare(r,e)})}function d(t){return function(e,n){var r=n().editor.mentions.usersTrie,s=r.getValue(t);if(null!=s)switch(s.status){case"SUCCESSFUL":return e(g.loadUsersSuccess(t,s.users));case"PENDING":return;case"FAILED":return e(g.loadUsersFailure(t,s.error))}var a=r.getValueFromPartialsOfWord(t);if(null!=a)switch(a.status){case"SUCCESSFUL":if(a.users.length<u)return e(g.loadUsersSuccess(t,l(a.users,t)))}e(g.loadUsersRequest(t));var c={name:t+"*",order:"mention",limit:u};return i.a.get("/users/by-names/",{params:c}).then(function(n){if(n.status>=500)throw new Error(n.data);var r=n.data.map(function(t){return t.domID="mentionSuggestion"+t.userID,t});e(g.loadUsersSuccess(t,r))}).catch(function(n){return e(g.loadUsersFailure(t,n))})}}var g={loadUsersRequest:function(t){return Object(r.b)(a,{username:t})},loadUsersFailure:function(t,e){return Object(r.b)(c,{username:t,error:e})},loadUsersSuccess:function(t,e){return Object(r.b)(o,{username:t,users:e})},setActiveSuggestion:function(t,e){return Object(r.b)(s,{suggestionID:t,suggestionIndex:e})}},v={loadUsers:d};!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(s,"SET_ACTIVE_SUGGESTION","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(a,"LOAD_USERS_REQUEST","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(c,"LOAD_USERS_FAILURE","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(o,"LOAD_USERS_SUCCESS","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(u,"USER_LIMIT","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(l,"filterSuggestions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(d,"loadUsers","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(g,"actions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),e.register(v,"thunks","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/mention/mentionActions.ts"),r(t))}()}).call(this,n(3)(t))},38:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return i}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return a});var r=n(13);!function(){var e=n(1).enterModule;e&&e(t)}();
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
var i="[instance] create",s="[instance] set selection",a={createInstance:function(t){return Object(r.b)(i,{editorID:t})},setSelection:function(t,e){return Object(r.b)(s,{editorID:t,selection:e})}};!function(){var e=n(1).default,r=n(1).leaveModule;e&&(e.register(i,"CREATE_INSTANCE","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),e.register(s,"SET_SELECTION","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),e.register(a,"actions","/git/srv/vanilla/plugins/rich-editor/src/scripts/state/instance/instanceActions.ts"),r(t))}()}).call(this,n(3)(t))}},[[170,2,0,1]]]);
//# sourceMappingURL=forum.min.js.map