(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{117:function(e,t,n){n(33),e.exports=n(120)},120:function(e,t,n){"use strict";n.r(t);var r=n(19),s=n(23),u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},a={lastSuccessfulUsername:null,currentUsername:null,usersTrie:new(function(){function e(){this.MAX_PARTIAL_LOOKUP_ITERATIONS=10,this.root={}}return e.prototype.insert=function(e,t){for(var n=this.root,r=0;r<e.length;r++){var s=e[r];if(n.children||(n.children={}),!(s in n.children)){var u=r!==e.length-1?{}:{children:{}};n.children[s]=u}n=n.children[s]}n.value=t},e.prototype.getNode=function(e){var t=this.root;if(void 0===e)return t;for(var n=0;n<e.length;n++){var r=e.charAt(n);if(!t.children||!t.children[r])return null;t=t.children[r]}return t},e.prototype.getValue=function(e){var t=this.getNode(e);return t&&t.value||null},e.prototype.getValueFromPartialsOfWord=function(e){for(var t=Math.min(this.MAX_PARTIAL_LOOKUP_ITERATIONS,e.length);t>0;t--){var n=e.substring(0,t),r=this.getValue(n);if(null!=r)return r}return null},e}()),activeSuggestionID:"",activeSuggestionIndex:0};var i=n(24),o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},c={index:0,length:0},l={},d={currentSelection:c,lastGoodSelection:c};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */function f(e,t){var n=e[t.payload.editorID];if(t.type===i.a&&n)throw new Error("Failed to create editor instance with id "+t.payload.editorID+". Id already exists");if(t.type!==i.a&&!n)throw new Error("Could not perform an action for editor ID "+t.payload.editorID+" that doesn't exist. Be sure to create an instance first.")}var g=n(13),h=Object(g.c)({mentions:function(e,t){switch(void 0===e&&(e=a),t.type){case s.b:var n=t.payload.username;e.usersTrie.insert(n,{status:"PENDING"});var r=!1,i=e.lastSuccessfulUsername;return null!=i&&n.length>i.length&&n.substring(0,i.length)===i&&(r=!0),u({},e,{currentUsername:n,lastSuccessfulUsername:r?e.lastSuccessfulUsername:null});case s.a:var o=t.payload,c=(n=o.username,o.error);return e.usersTrie.insert(n,{status:"FAILED",users:null,error:c}),e;case s.c:var l=t.payload,d=(n=l.username,l.users);e.usersTrie.insert(n,{status:"SUCCESSFUL",users:function(e,t){var n=Intl.Collator("en",{usage:"sort",sensitivity:"variant",ignorePunctuation:!0,numeric:!0});return e.sort(function(e,r){return e.name.includes(t)&&!r.name.includes(t)?-1:r.name.includes(t)&&!e.name.includes(t)?1:n.compare(e.name,r.name)})}(d,n)});var f=d.length>0?d[0].domID:"";return u({},e,{activeSuggestionID:f,activeSuggestionIndex:0,lastSuccessfulUsername:n,currentUsername:n===e.currentUsername?null:e.currentUsername});case s.d:var g=t.payload,h=g.suggestionID,m=g.suggestionIndex;return u({},e,{activeSuggestionID:h,activeSuggestionIndex:m});default:return e}},instances:function(e,t){var n,r;switch(void 0===e&&(e=l),t.type){case i.a:return f(e,t),o({},e,((n={})[t.payload.editorID]=d,n));case i.b:f(e,t);var s=t.payload,u=s.selection,a=s.editorID,c=e[a],g=c.lastGoodSelection;return o({},e,((r={})[a]=o({},c,{currentSelection:u,lastGoodSelection:null!==u?u:g}),r));default:return e}}}),m=n(1);
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
/*
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */
Object(m.k)(function(){var e;Object(r.b)("editor",h),(e=document.querySelectorAll(".richEditor")).length>0&&Promise.all([n.e(0),n.e(6)]).then(n.bind(null,342)).then(function(t){e.forEach(t.default)}),document.addEventListener("X-EditCommentFormLoaded",function(e){var t=e.target;if(t instanceof Element){var r=t.querySelector(".richEditor");r&&Promise.all([n.e(0),n.e(6)]).then(n.bind(null,342)).then(function(e){e.default(r)})}})})},23:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return d});var r=n(10),s=n(7),u="[mentions] set active suggestion",a="[mentions] load users request",i="[mentions] load users failure",o="[mentions] load users success",c=50;var l={loadUsersRequest:function(e){return Object(r.b)(a,{username:e})},loadUsersFailure:function(e,t){return Object(r.b)(i,{username:e,error:t})},loadUsersSuccess:function(e,t){return Object(r.b)(o,{username:e,users:t})},setActiveSuggestion:function(e,t){return Object(r.b)(u,{suggestionID:e,suggestionIndex:t})}},d={loadUsers:function(e){return function(t,n){var r=n().editor.mentions.usersTrie,u=r.getValue(e);if(null!=u)switch(u.status){case"SUCCESSFUL":return t(l.loadUsersSuccess(e,u.users));case"PENDING":return;case"FAILED":return t(l.loadUsersFailure(e,u.error))}var a,i,o,d=r.getValueFromPartialsOfWord(e);if(null!=d)switch(d.status){case"SUCCESSFUL":if(d.users.length<c)return t(l.loadUsersSuccess(e,(a=d.users,i=e,o=Intl.Collator("en",{usage:"search",sensitivity:"base",ignorePunctuation:!0,numeric:!0}),a.filter(function(e){if(e.name.length<i.length)return!1;var t=e.name.substring(0,i.length);return 0===o.compare(t,i)}))))}t(l.loadUsersRequest(e));var f={name:e+"*",order:"mention",limit:c};return s.a.get("/users/by-names/",{params:f}).then(function(n){if(n.status>=500)throw new Error(n.data);var r=n.data.map(function(e){return e.domID="mentionSuggestion"+e.userID,e});t(l.loadUsersSuccess(e,r))}).catch(function(n){return t(l.loadUsersFailure(e,n))})}}}},24:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return a});var r=n(10),s="[instance] create",u="[instance] set selection",a={createInstance:function(e){return Object(r.b)(s,{editorID:e})},setSelection:function(e,t){return Object(r.b)(u,{editorID:e,selection:t})}};
/**
 * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>
 * @copyright 2009-2018 Vanilla Forums Inc.
 * @license https://opensource.org/licenses/GPL-2.0 GPL-2.0
 */}},[[117,2,0,1]]]);