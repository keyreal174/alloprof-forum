{"version":3,"sources":["webpack://vanillaforum/./applications/dashboard/src/scripts/legacy/atwho.ts","webpack://vanillaforum/./library/src/scripts/components/DocumentTitle.tsx","webpack://vanillaforum/./library/src/scripts/components/NotFoundPage.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/Router.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/legacy/index.ts","webpack://vanillaforum/./library/src/scripts/user-content/embeds/BaseEmbed.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/codepen.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/giphy.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/image.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/imgur.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/instagram.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/link.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/soundcloud.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/twitter.ts","webpack://vanillaforum/./library/src/scripts/user-content/embeds/video.tsx","webpack://vanillaforum/./library/src/scripts/user-content/spoilers.ts","webpack://vanillaforum/./library/src/scripts/user-content/CollapsableContent.tsx","webpack://vanillaforum/./library/src/scripts/user-content/embeds/quote.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/authenticatorsActions.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/authenticatorsReducer.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/recoverPassword/recoverPasswordActions.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/recoverPassword/recoverPasswordReducer.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/authenticateReducer.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/usersReducer.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/Or.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/Paragraph.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/components/SSOMethods.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/ErrorMessages.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/InputTextBlock.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/Checkbox.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/Button.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/components/forms/ButtonSubmit.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/passwordActions.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/components/PasswordForm.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/SignInPage.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/PasswordPage.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/authenticate/components/RememberPasswordLink.tsx","webpack://vanillaforum/./applications/dashboard/src/scripts/pages/recoverPassword/RecoverPasswordPage.tsx","webpack://vanillaforum/./library/src/scripts/user-content/emoji.ts","webpack://vanillaforum/./library/src/scripts/user-content/index.ts","webpack://vanillaforum/./applications/dashboard/src/scripts/entries/forum.tsx","webpack://vanillaforum/./build/entries/public-path.ts","webpack://vanillaforum/./library/src/scripts/user-content/embeds/getty.ts"],"names":["rawMatch","_super","DocumentTitle","__extends","prototype","componentDidMount","document","title","this","getHeadTitle","props","componentWillUpdate","nextProps","render","children","react_default","a","createElement","siteTitle","Object","application","parts","length","push","join","Component","NotFoundPage","NotFoundPage_extends","className","components_DocumentTitle","message","defineProperty","sprintf","type","toLowerCase","defaultProps","PureComponent","Router","Router_extends","routes","map","route","__assign","key","path","exact","Route","component","components_NotFoundPage","es","store","getStore","BrowserRouter","basename","Switch","atCache","atEmpty","minCharacters","maxSuggestions","serverLimit","emojiData","emojis","emoji","emojiFormat","format","emojiAssetPath","assetPath","emojiList","entries","_a","_b","__read","index","emojiImageUrl","split","name","filename","ext","emojiTemplate","replace","matchAtMention","flag","subtext","shouldStartWithSpace","match","utility","matchFakeEmoji","RegExp","exec","initializeAtComplete","editorElement","iframe","iframeWindow","contentWindow","$","atwho","at","tpl","limit","callbacks","remote_filter","query","callback","shouldContinueFiltering","filterString","i","l","slice","isQueryEmpty","hasOwnProperty","getJSON","q","data","Array","isArray","forEach","result","before_insert","value","$li","username","requiresQuotation","test","hasQuotation","insert","highlighter","li","regexp","str","$1","$2","$3","$4","matcher","cWindow","insert_tpl","tplEval","on","event","offset","context","suggestionElement","view","$el","$inputor","lineHeight","parseInt","css","iframeOffset","leftCoordinate","left","topCoordinate","top","selectHeight","text","fontMirror","font","fontWidth","width","each","element","outerHeight","height","windowHeight","window","scrollPosition","scrollTop","newOffset","fn","gdn","atCompleteInit","BaseEmbed","BaseEmbed_extends","onRenderComplete","codepen_CodePenEmbed","CodePenEmbed","codepen_extends","attributes","id","src","style","scrolling","embeds_BaseEmbed","giphy_GiphyEmbed","GiphyEmbed","giphy_extends","postID","ratioStyle","maxWidth","paddingBottom","Error","image_ImageEmbed","ImageEmbed","image_extends","url","sanitizedUrl","href","rel","target","alt","imgur_ImgurEmbed","ImgurEmbed","imgur_extends","dataID","isAlbum","data-id","convertImgurEmbeds","then","componentDidUpdate","images","from","querySelectorAll","dom","sent","imgurEmbed","createIframe","imagesLength","tasks","instagram_InstagramEmbed","InstagramEmbed","instagram_extends","permaLink","versionNumber","isCaptioned","data-instgrmPermalink","data-instgrmVersion","data-instgrmCaptioned","convertInstagramEmbeds","instgrm","Embeds","process","link_LinkEmbed","LinkEmbed","link_extends","photoUrl","body","source","linkImage","aria-hidden","dateTime","timestamp","humanTime","truncateEmbedLinks","container","el","untruncatedText","innerHTML","excerpt","maxHeight","getComputedStyle","shave_es","truncateTextBasedOnMaxHeight","soundcloud_SoundcloudEmbed","SoundcloudEmbed","soundcloud_extends","visual","showArtwork","embedUrl","frameBorder","renderTweet","elements","contentElement","content","twttr","statusID","classList","contains","add","options","conversation","widgets","createTweet","querySelector","remove","convertTwitterEmbeds","tweets","promises","getAttribute","root","Promise","all","video_VideoEmbed","VideoEmbed","_this","call","clickHandler","setState","isPlaying","state","video_extends","ratioClass","paddingTop","thumbnail","data-url","aria-label","undefined","onClick","role","PlayIcon","VideoIframe","shorthand","allow","allowFullScreen","fill","strokeWidth","xmlns","viewBox","d","points","handlePlayVideo","closest","dataset","react_dom_default","handleToggleSpoiler","spoilerContainer","toggle","CollapsableUserContent","apply","arguments","selfRef","createRef","CollapsableContent_extends","overflow","ref","dangerouslySetInnerHTML","calcMaxHeight","addEventListener","debounce_default","prevProps","__html","isCollapsed","getHeightInfo","self","current","needsCollapser","childElementCount","finalMaxHeight","lastBottomMargin","__values","_c","next","done","child","preferredMaxHeight","_d","bottomMargin","scrollHeight","setNeedsCollapser","mountQuoteEmbeds","embeds","embed","quoteData","JSON","parse","quote_QuoteEmbed","inEditor","removeAttribute","embeds_1","quote_values","embeds_1_1","ChevronUpIcon","stroke-linecap","fill-rule","transform","ChevronDownIcon","QuoteEmbed","renderedBody","needsCollapseButton","toggleCollapseState","preventDefault","quote_extends","insertUser","uniqueId_default","bodyClasses","classnames_default","userUrl","tabIndex","titleTime","aria-pressed","CollapsableContent","stringify","bodyRaw","apiv2","post","response","quote","dateUpdated","dateInserted","Date","toLocaleString","year","month","day","weekday","hour","minute","GET_USER_AUTHENTICATORS_REQUEST","GET_USER_AUTHENTICATORS_SUCCESS","GET_USER_AUTHENTICATORS_ERROR","getAuthenticatorsActions","state_utility","getUserAuthenticators","initialState","status","api","PENDING","POST_REQUEST_PASSWORD_REQUEST","POST_REQUEST_PASSWORD_ERROR","POST_REQUEST_PASSWORD_SUCCESS","AFTER_REQUEST_PASSWORD_SUCCESS_NAVIGATE","afterRequestPasswordSuccessNavigate","requestPasswordActions","postRequestPassword","params","recoverPasswordReducer_initialState","passwordReducer","action","recoverPasswordReducer_assign","LOADING","SUCCESS","payload","error","ERROR","authenticate_authenticateReducer","redux","authenticators","authenticatorsReducer_assign","password","scripts_usersReducer","requestPassword","Or","Or_extends","visible","Paragraph","componentIDs","Paragraph_extends","componentClasses","isError","accessibilityProps","aria-live","Paragraph_assign","SSOMethods","SSOMethods_extends","ssoMethods","method","methodStyles","backgroundColor","ui","color","foregroundColor","buttonName","forms_Paragraph","ErrorMessages","ErrorMessages_extends","errors","errorList","InputTextBlock","inputRef","onChange","InputTextBlock_extends","describedBy","inputClasses","inputClassNames","hasErrors","errorID","labelID","label","labelNote","defaultValue","disabled","required","placeholder","aria-invalid","aria-describedby","aria-labelledby","forms_ErrorMessages","componentWillUnount","removeEventListener","focus","select","Button","Checkbox_extends","checked","prefix","Button_extends","ButtonSubmit","ButtonSubmit_extends","forms_Button","authenticatePasswordActions","postAuthenticatePassword","dispatch","request","success","urlParms","URLSearchParams","location","get","catch","axiosError","PasswordForm_PasswordForm","PasswordForm","usernameInput","passwordInput","handleCheckBoxChange","rememberMe","handleUsernameChange","handlePasswordChange","handleSubmit","authenticate","persist","PasswordForm_extends","formDescribedBy","globalErrorMessage","passwordState","formDescriptionID","onSubmit","noValidate","forms_InputTextBlock","allowEdit","defaultUsername","Checkbox","Link","to","forms_ButtonSubmit","allowSubmit","components_PasswordForm","withRouter","SignInPage_SignInPage","SignInPage","SignInPage_extends","authenticatorState","loadAuthenticators","showPassword","filter","react","titleID","components_SSOMethods","forms_Or","authenticate_SignInPage","PasswordPage","PasswordPage_extends","RememberPasswordLink","RememberPasswordLink_extends","RecoverPasswordPage_RecoverPasswordPage","RecoverPasswordPage","emainInput","handleEmailChange","email","pageTitleID","RecoverPasswordPage_extends","pageTitle","requestPasswordState","components_RememberPasswordLink","onNavigateAway","recoverPassword_RecoverPasswordPage","users","scripts_embeds","getty","reducerRegistry","components_Router","authenticate_PasswordPage","_library_application__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","p","_library_application__WEBPACK_IMPORTED_MODULE_2__","initGettyEmbeds","_library_embeds__WEBPACK_IMPORTED_MODULE_0__","renderGetty","convertGettyEmbeds","newLink","setAttribute","appendChild","setImmediate","loadGettyImages","gettyPosts","gettyPosts_1","gettyPosts_1_1","sig","Number","items","capt","tld","i360","fallbackCallback","c","gie","load","w","h","caption","is360","_library_dom__WEBPACK_IMPORTED_MODULE_1__"],"mappings":"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","file":"/applications/dashboard/js/webpack/forum.min.js?e49b686f09e8e6893188","sourcesContent":["/**\n * At-who setup for legacy @mentions.\n *\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { formatUrl, getMeta } from \"@library/application\";\nimport { log, matchAtMention as _matchAtMention } from \"@library/utility\";\n\n// Store cache results in an outer scoped variable., so all instances share the same data\n// and can build the cache together.\nconst atCache = {};\nconst atEmpty = {};\n\n// The current raw match. This is needed to properly match quoted strings.\nlet rawMatch: string | undefined;\n\n// Set minimum characters to type for @mentions to fire\nconst minCharacters = getMeta(\"mentionMinChars\", 2);\n\n// Max suggestions to show in dropdown.\nconst maxSuggestions = getMeta(\"mentionSuggestionCount\", 5);\n\n// Server response limit. This should match the limit set in\n// *UserController->TagSearch* and UserModel->TagSearch\nconst serverLimit = 30;\n\n// Emoji, set in definition list in foot, by Emoji class. Make sure\n// that class is getting instantiated, otherwise emoji will be empty.\n\ninterface IEmojiData {\n    assetPath?: string;\n    emoji?: {\n        [key: string]: string;\n    };\n    format?: string;\n}\n\nconst emojiData: IEmojiData = getMeta(\"emoji\", {});\nconst emojis = emojiData.emoji || {};\nconst emojiFormat = emojiData.format || \"\";\nconst emojiAssetPath = emojiData.assetPath || \"\";\n\nconst emojiList = Object.entries(emojis).map(([index, emojiImageUrl]) => {\n    const parts = emojiImageUrl.split(\".\");\n\n    return { name: index, filename: emojiImageUrl, basename: parts[0], ext: \".\" + parts[1] };\n});\n\nconst emojiContentTemplate = emojiFormat\n    .replace(/{(.+?)}/g, \"$${$1}\")\n    .replace(\"%1$s\", \"${src}\")\n    .replace(\"%2$s\", \"${name}\")\n    .replace(\"${src}\", emojiAssetPath + \"/${filename}\")\n    .replace(\"${dir}\", emojiAssetPath);\nconst emojiTemplate =\n    '<li data-value=\":${name}:\" class=\"at-suggest-emoji\"><span class=\"emoji-wrap\">' +\n    emojiContentTemplate +\n    '</span> <span class=\"emoji-name\">${name}</span></li>';\n\n/**\n * Match an @mention\n *\n * @param flag - The character sequence used to trigger this match (e.g. :).\n * @param subtext - The string to be tested.\n * @param shouldStartWithSpace - Should the pattern include a test for a whitespace prefix?\n * @returns Matching string if successful. Null on failure to match.\n */\nexport function matchAtMention(flag: string, subtext: string, shouldStartWithSpace: boolean): string | null {\n    const match = _matchAtMention(subtext, shouldStartWithSpace);\n    if (match) {\n        rawMatch = match.rawMatch;\n        return match.match;\n    }\n\n    return null;\n}\n\n/**\n * Custom matching for our emoji images. Eg. :) :/ >:(\n *\n * @param flag - The character sequence used to trigger this match (e.g. :).\n * @param subtext - The string to be tested.\n * @param shouldStartWithSpace - Should the pattern include a test for a whitespace prefix?\n * @returns Matching string if successful.  Null on failure to match.\n */\nexport function matchFakeEmoji(flag, subtext, shouldStartWithSpace) {\n    flag = flag.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n    if (shouldStartWithSpace) {\n        flag = \"(?:^|\\\\s)\" + flag;\n    }\n\n    // Some browsers append a linefeed to the end of subtext.  We need to allow for it.\n    const regexp = new RegExp(flag + \"([A-Za-z0-9_+-]*|[^\\\\x00-\\\\xff]*)(?:\\\\n)?$\", \"gi\");\n    const match = regexp.exec(subtext);\n\n    if (match) {\n        return match[2] || match[1];\n    } else {\n        return null;\n    }\n}\n\nexport function initializeAtComplete(editorElement, iframe?: any) {\n    // Handle iframe situation\n    const iframeWindow = iframe ? iframe.contentWindow : \"\";\n\n    const remoteDataHandler = (query, callback) => {\n        // Do this because of undefined when adding spaces to\n        // matcher callback, as it will be monitoring changes.\n        query = query || \"\";\n\n        // Only all query strings greater than min_characters\n        if (query.length >= minCharacters) {\n            // If the cache array contains less than LIMIT 30\n            // (according to server logic), then there's no\n            // point sending another request to server, as there\n            // won't be any more results, as this is the maximum.\n            let shouldContinueFiltering = true;\n\n            // Remove last character so that the string can be\n            // found in the cache, if exists, then check if its\n            // matching array has less than the server limit of\n            // matches, which means there are no more, so save the\n            // additional server request from being sent.\n            let filterString = \"\";\n\n            // Loop through string and find first closest match in\n            // the cache, and if a match, check if more filtering\n            // is required.\n            for (let i = 0, l = query.length; i < l; i++) {\n                filterString = query.slice(0, -i);\n\n                if (atCache[filterString] && atCache[filterString].length < serverLimit) {\n                    // Add this other query to empty array, so that it\n                    // will not fire off another request.\n                    atEmpty[query] = query;\n\n                    // Do not filter more, meaning, do not send\n                    // another server request, as all the necessary\n                    // data is already in memory.\n                    shouldContinueFiltering = false;\n                    break;\n                }\n            }\n\n            // Check if query would be empty, based on previously\n            // cached empty results. Compare against the start of\n            // the latest query string.\n            let isQueryEmpty = false;\n\n            // Loop through cache of empty query strings.\n            for (const key in atEmpty) {\n                if (atEmpty.hasOwnProperty(key)) {\n                    // See if cached empty results match the start\n                    // of the latest query. If so, then no point\n                    // sending new request, as it will return empty.\n                    if (query.match(new RegExp(\"^\" + key + \"+\")) !== null) {\n                        isQueryEmpty = true;\n                        break;\n                    }\n                }\n            }\n\n            const filterSuccessHandler = data => {\n                if (Array.isArray(data)) {\n                    data.forEach(result => {\n                        if (typeof result === \"object\" && typeof result.name === \"string\") {\n                            // Convert special characters to safely insert into template.\n                            result.name = result.name\n                                .replace(/&/g, \"&amp;\")\n                                .replace(/</g, \"&lt;\")\n                                .replace(/>/g, \"&gt;\")\n                                .replace(/\"/g, \"&quot;\")\n                                .replace(/'/g, \"&apos;\");\n                        }\n                    });\n                }\n\n                callback(data);\n\n                // If data is empty, cache the results to prevent\n                // other requests against similarly-started\n                // query strings.\n                if (data.length) {\n                    atCache[query] = data;\n                } else {\n                    atEmpty[query] = query;\n                }\n            };\n\n            // Produce the suggestions based on data either\n            // cached or retrieved.\n            if (shouldContinueFiltering && !isQueryEmpty && !atCache[query]) {\n                $.getJSON(\n                    formatUrl(\"/user/tagsearch\"),\n                    {\n                        q: query,\n                        limit: serverLimit,\n                    },\n                    filterSuccessHandler,\n                );\n            } else {\n                // If no point filtering more as the parent filter\n                // has not been maxed out with responses, use the\n                // closest parent filter instead of the latest\n                // query string.\n                if (!shouldContinueFiltering) {\n                    callback(atCache[filterString]);\n                } else {\n                    callback(atCache[query]);\n                }\n            }\n        }\n    };\n\n    /**\n     * Pre-insert handler for atwho.\n     *\n     * Note, in contenteditable mode (iframe for us), the value is surrounded by span tags.\n     */\n    function beforeInsertHandler(value: string, $li: JQuery<any>): string {\n        // It's better to use the value provided, as it may have\n        // html tags around it, depending on mode. Using the\n        // regular expression avoids the need to check what mode\n        // the suggestion is made in, and then constructing\n        // it based on that. Optional assignment for undefined\n        // matcher callback results.\n        let username = $li.data(\"value\") || \"\";\n        // Pop off the flag--usually @ or :\n        username = username.slice(1, username.length);\n\n        // Check if there are any whitespaces, and if so, add\n        // quotation marks around the whole name.\n        const requiresQuotation = /[^\\w-]/.test(username);\n\n        // Check if there are already quotation marks around\n        // the string--double or single.\n        const hasQuotation = /([\"'])(.+)([\"'])/g.test(username);\n\n        let insert = username;\n        if (requiresQuotation && !hasQuotation) {\n            // Do not even need to have value wrapped in\n            // any tags at all. It will be done automatically.\n            // insert = value.replace(/(.*\\>?)@([\\w\\d\\s\\-\\+\\_]+)(\\<?.*)/, '$1@\"$2\"$3');\n            insert = '\"' + username + '\"';\n        }\n\n        // This is needed for checking quotation mark directly\n        // after at character, and preventing another at character\n        // from being inserted into the page.\n        const rawAtMatch = rawMatch || \"\";\n\n        const atQuote = /.?@([\"'])/.test(rawAtMatch);\n\n        // If atQuote is false, then insert the at character,\n        // otherwise it means the user typed a quotation mark\n        // directly after the at character, which, would get\n        // inserted again if not checked. atQuote would\n        // be false most of the time; the exception is when\n        // it's true.\n        if (!atQuote) {\n            insert = this.at + insert;\n        }\n\n        // The last character prevents the matcher from trigger on nearly everything.\n        return insert;\n    }\n\n    /**\n     * Custom highlighting to accept spaces in names.\n     * This is almost a copy of the default in the library, with tweaks in the regex.\n     */\n    function highlightHandler(li: string, query: string): string {\n        if (!query) {\n            return li;\n        }\n        const regexp = new RegExp(\">\\\\s*(\\\\w*)(\" + query.replace(\"+\", \"\\\\+\") + \")(\\\\w*)\\\\s*(\\\\s+.+)?<\", \"ig\");\n        // Capture group 4 for possible spaces\n        return li.replace(regexp, (str, $1, $2, $3, $4) => {\n            // Weird Chrome behaviour, so check for undefined, then\n            // set to empty string if so.\n            if (typeof $3 === \"undefined\") {\n                $3 = \"\";\n            }\n            if (typeof $4 === \"undefined\") {\n                $4 = \"\";\n            }\n\n            return \"> \" + $1 + \"<strong>\" + $2 + \"</strong>\" + $3 + $4 + \" <\";\n        });\n    }\n\n    $(editorElement)\n        .atwho({\n            at: \"@\",\n            tpl: '<li data-value=\"@${name}\" data-id=\"${id}\">${name}</li>',\n            limit: maxSuggestions,\n            callbacks: {\n                remote_filter: remoteDataHandler,\n                before_insert: beforeInsertHandler,\n                highlighter: highlightHandler,\n                matcher: matchAtMention,\n            },\n            cWindow: iframeWindow,\n        })\n        .atwho({\n            at: \":\",\n            tpl: emojiTemplate,\n            insert_tpl: \"${atwho-data-value}\",\n            callbacks: {\n                matcher: matchFakeEmoji,\n                tplEval: (tpl, map) => log(map),\n            },\n            limit: maxSuggestions,\n            data: emojiList,\n            cWindow: iframeWindow,\n        });\n\n    /**\n     * This hook is triggered when atWho places a selection list in the window.\n     * The context is passed implicitly when triggered by at.js.\n     *\n     * @param event - A custom event triggered by the advanced editor iframe/wysiwyg.\n     * @param offset - The pixel offsets inside of the iframe.\n     * @param context - Context from the contenteditable inside of the iframe.\n     */\n    function iframeAtWhoRepositionHandler(event: any, offset: any, context: any) {\n        // Actual suggestion box that will appear.\n        const suggestionElement = context.view.$el;\n\n        // The area where text will be typed (contenteditable body).\n        const $inputor = context.$inputor;\n\n        // Display it below the text.\n        const lineHeight = parseInt($inputor.css(\"line-height\"), 10);\n\n        // offset contains the top left values of the offset to the iframe\n        // we need to convert that to main window coordinates\n        const iframeOffset = $(iframe).offset();\n        let leftCoordinate = (iframeOffset ? iframeOffset.left : 0) + offset.left;\n        let topCoordinate = iframeOffset ? iframeOffset.top : 0;\n        let selectHeight = 0;\n\n        // In wysiwyg mode, the suggestbox follows the typing, which\n        // does not happen in regular mode, so adjust it.\n        // Either @ or : for now.\n        const at = context.at;\n        const { text } = context.query;\n        const fontMirror = $(\".BodyBox,.js-bodybox\");\n        const font = fontMirror.css(\"font-size\") + \" \" + fontMirror.css(\"font-family\");\n\n        // Get font width\n        const fontWidth = (at + text).width(font) - 2;\n\n        if (at === \"@\") {\n            leftCoordinate -= fontWidth;\n        }\n\n        if (at === \":\") {\n            leftCoordinate -= 2;\n        }\n\n        // atWho adds 3 select areas, presumably for differnet positing on screen (above below etc)\n        // This finds the active one and gets the container height\n        $(suggestionElement).each((index, element) => {\n            const outerHeight = $(element).outerHeight();\n            const height = $(element).height();\n\n            if (outerHeight && height && outerHeight > 0) {\n                selectHeight += height + lineHeight;\n            }\n        });\n\n        // Now should we show the selection box above or below?\n        const windowHeight = $(window).height() || 0;\n        const scrollPosition = $(window).scrollTop() || 0;\n        const selectionPosition = topCoordinate + offset.top - ($(window).scrollTop() || 0);\n        const iAvailableSpace = windowHeight - (selectionPosition - scrollPosition);\n\n        if (iAvailableSpace >= selectHeight) {\n            // Enough space below\n            topCoordinate = topCoordinate + offset.top + selectHeight - scrollPosition;\n        } else {\n            // Place it above instead\n            // @todo should check if this is more space than below\n            topCoordinate = topCoordinate + offset.top - scrollPosition;\n        }\n\n        // Move the select box\n        const newOffset = {\n            left: leftCoordinate,\n            top: topCoordinate,\n        };\n        $(suggestionElement).offset(newOffset);\n    }\n\n    // Only necessary for iframe.\n    // Based on work here: https://github.com/ichord/At.js/issues/124\n    if (iframeWindow) {\n        $(iframeWindow).on(\"reposition.atwho\", iframeAtWhoRepositionHandler);\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { getMeta } from \"@library/application\";\n\n/**\n * A component for displaying and setting the document title.\n *\n * This component can render a default title or a custom title depending on the usage.\n *\n * @example <caption>Render the title in the default h1</caption>\n * <DocumentTitle title=\"Page Title\" />\n *\n * @example <caption>Render a custom title</caption>\n * <DocumentTitle title=\"Title Bar Title >\n *     <h1>Page Title</h1>\n * </DocumentTitle>\n */\nexport default class DocumentTitle extends React.Component<IProps> {\n    public componentDidMount() {\n        document.title = this.getHeadTitle(this.props);\n    }\n\n    public componentWillUpdate(nextProps: IProps) {\n        document.title = this.getHeadTitle(nextProps);\n    }\n\n    public render() {\n        if (this.props.children) {\n            return this.props.children;\n        } else {\n            return <h1>{this.props.title}</h1>;\n        }\n    }\n\n    /**\n     * Calculate the status bar title from the props.\n     *\n     * @param props - The props used to calculate the title.\n     * @returns Returns the title as a string.\n     */\n    private getHeadTitle(props: IProps): string {\n        const siteTitle: string = getMeta(\"ui.siteName\", \"\");\n        const parts: string[] = [];\n\n        if (props.title && props.title.length > 0) {\n            parts.push(props.title);\n        }\n        if (siteTitle.length > 0 && siteTitle !== props.title) {\n            parts.push(siteTitle);\n        }\n\n        return parts.join(\" - \");\n    }\n}\n\ninterface IProps {\n    title: string;\n    children?: React.ReactNode;\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { sprintf } from \"sprintf-js\";\nimport { t } from \"@library/application\";\nimport DocumentTitle from \"@library/components/DocumentTitle\";\n\nexport default class NotFoundPage extends React.PureComponent<IProps> {\n    public static defaultProps = {\n        type: \"Page\",\n    };\n\n    public render() {\n        return (\n            <div className=\"Center SplashInfo\">\n                <DocumentTitle title={this.title} />\n                <div>{this.message}</div>\n            </div>\n        );\n    }\n\n    private get title() {\n        return this.props.title || sprintf(t(\"%s Not Found\"), t(this.props.type));\n    }\n\n    private get message() {\n        return (\n            this.props.message ||\n            sprintf(t(\"The %s you were looking for could not be found.\"), t(this.props.type.toLowerCase()))\n        );\n    }\n}\n\ninterface IProps {\n    type: string;\n    title?: string;\n    message?: string;\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { BrowserRouter, Route, RouteProps, Switch } from \"react-router-dom\";\nimport { Provider } from \"react-redux\";\nimport { getRoutes, getMeta } from \"@library/application\";\nimport NotFoundPage from \"@library/components/NotFoundPage\";\nimport getStore from \"@library/state/getStore\";\n\n/**\n * The root application component.\n *\n * This component renders the top-level pages that have been registered with {@link module:application.addRoutes}.\n */\nexport default class Router extends React.PureComponent {\n    public render() {\n        const routes = getRoutes().map((route: React.ReactElement<RouteProps>) => {\n            return <route.type key={route.key || route.props.path + (route.props.exact ? \"!\" : \"\")} {...route.props} />;\n        });\n\n        routes.push(<Route key=\"@not-found\" component={NotFoundPage} />);\n\n        return (\n            <Provider store={getStore()}>\n                <BrowserRouter basename={getMeta(\"context.basePath\", \"\")}>\n                    <Switch>{routes}</Switch>\n                </BrowserRouter>\n            </Provider>\n        );\n    }\n}\n","/**\n * Entrypoint for gradually replacing global.js\n *\n * At some point everything in this folder should be able to be removed (new base theme).\n *\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { onContent, onReady } from \"@library/application\";\nimport { initializeAtComplete } from \"@dashboard/legacy/atwho\";\n\n// Initialize legacy @mentions for all BodyBox elements.\nif ($.fn.atwho) {\n    onReady(() => initializeAtComplete(\".BodyBox,.js-bodybox\"));\n    onContent(() => initializeAtComplete(\".BodyBox,.js-bodybox\"));\n\n    // Also assign this function to the global `gdn` object.\n    // The advanced editor calls this function directly when in wysiwyg format, as it needs to\n    // handle an iframe, and the editor instance needs to be referenced. The advanced editor does not yet use\n    // this build process so it can only communicate through here with a global.\n    window.gdn.atCompleteInit = initializeAtComplete;\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { IEmbedProps } from \"@library/embeds\";\n\n/**\n * A base embed react component class.\n * @see {registerEmbedComponent}\n */\nexport default abstract class BaseEmbed<P extends IEmbedProps = IEmbedProps, S = {}> extends React.Component<P, S> {\n    public componentDidMount() {\n        this.props.onRenderComplete();\n    }\n\n    public abstract render();\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initCodePenEmbeds() {\n    registerEmbedComponent(\"codepen\", CodePenEmbed);\n}\n\nexport class CodePenEmbed extends BaseEmbed {\n    public render() {\n        const { attributes, height } = this.props.data;\n        const { id, src, style } = attributes;\n\n        return <iframe id={id} src={src} height={height || 300} style={style} scrolling=\"no\" />;\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initGiphyEmbeds() {\n    registerEmbedComponent(\"giphy\", GiphyEmbed);\n}\n\nexport class GiphyEmbed extends BaseEmbed {\n    public render() {\n        const { data } = this.props;\n        const { attributes, width, height } = data;\n        const { postID } = attributes;\n        const paddingBottom = ((height || 1) / (width || 1)) * 100 + \"%\";\n        const ratioStyle: React.CSSProperties = {\n            maxWidth: width ? width + \"px\" : \"100%\",\n            paddingBottom,\n        };\n\n        if (!postID) {\n            throw new Error(\"Giphy embed fail, the post could not be found\");\n        }\n        const src = `https://giphy.com/embed/${postID}`;\n\n        return (\n            <div className=\"embedExternal-ratio\" style={ratioStyle}>\n                <iframe src={src} className=\"giphy-embed embedGiphy-iframe\" />\n            </div>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { registerEmbedComponent } from \"@library/embeds\";\nimport { sanitizeUrl } from \"@library/utility\";\n\nexport function initImageEmbeds() {\n    registerEmbedComponent(\"image\", ImageEmbed);\n}\n\nexport class ImageEmbed extends BaseEmbed {\n    public render() {\n        const { data } = this.props;\n        const { url, name } = data;\n        const sanitizedUrl = sanitizeUrl(url);\n\n        // Yes we actually want a target blank here (even if we don't want it on normal links).\n        return (\n            <a className=\"embedImage-link\" href={sanitizedUrl || \"\"} rel=\"nofollow noopener\" target=\"_blank\">\n                <img className=\"embedImage-img\" src={url || \"\"} alt={name || \"\"} />\n            </a>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { ensureScript } from \"@library/dom\";\nimport { onContent } from \"@library/application\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initImgurEmbeds() {\n    registerEmbedComponent(\"imgur\", ImgurEmbed);\n    onContent(convertImgurEmbeds);\n}\n\nexport class ImgurEmbed extends BaseEmbed {\n    public render() {\n        const { data } = this.props;\n        const { attributes } = data;\n        const { postID, isAlbum } = attributes;\n\n        const dataID = isAlbum ? `a/${postID}` : postID;\n        const url = `//imgur.com/${postID}`;\n\n        return <blockquote className=\"imgur-embed-pub\" data-id={dataID} />;\n    }\n\n    public componentDidMount() {\n        void convertImgurEmbeds().then(this.props.onRenderComplete);\n    }\n\n    public componentDidUpdate() {\n        void convertImgurEmbeds().then(this.props.onRenderComplete);\n    }\n}\n\n/**\n * Renders posted imgur embeds.\n */\nexport async function convertImgurEmbeds() {\n    const images = Array.from(document.querySelectorAll(\".imgur-embed-pub\"));\n    if (images.length > 0) {\n        await ensureScript(\"//s.imgur.com/min/embed.js\");\n\n        if (!window.imgurEmbed) {\n            throw new Error(\"The Imgur post failed to load\");\n        }\n\n        if (window.imgurEmbed.createIframe) {\n            const imagesLength = images.length;\n            for (let i = 0; i < imagesLength; i++) {\n                window.imgurEmbed.createIframe();\n            }\n        } else {\n            window.imgurEmbed.tasks = images.length;\n        }\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { ensureScript } from \"@library/dom\";\nimport { onContent } from \"@library/application\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initInstagramEmbeds() {\n    registerEmbedComponent(\"instagram\", InstagramEmbed);\n    onContent(convertInstagramEmbeds);\n}\n\nexport class InstagramEmbed extends BaseEmbed {\n    public render() {\n        const { data } = this.props;\n        const { attributes, url } = data;\n        const { permaLink, versionNumber, isCaptioned } = attributes;\n        if (!data.attributes.permaLink) {\n            throw new Error(\"Attempted to embed a Instagram post failed link is invalid\");\n        }\n\n        return (\n            <blockquote\n                className=\"instagram-media\"\n                data-instgrmPermalink={permaLink}\n                data-instgrmVersion={versionNumber}\n                data-instgrmCaptioned={isCaptioned}\n            >\n                <a href={url}>{url}</a>\n            </blockquote>\n        );\n    }\n\n    public componentDidMount() {\n        void convertInstagramEmbeds().then(this.props.onRenderComplete);\n    }\n\n    public componentDidUpdate() {\n        void convertInstagramEmbeds().then(this.props.onRenderComplete);\n    }\n}\n\n/**\n * Renders posted instagram embeds.\n */\nexport async function convertInstagramEmbeds() {\n    const instagramEmbeds = document.querySelectorAll(\".instagram-media\");\n    if (instagramEmbeds.length > 0) {\n        await ensureScript(\"//platform.instagram.com/en_US/embeds.js\");\n\n        if (!window.instgrm) {\n            throw new Error(\"The Instagram post failed to load\");\n        }\n\n        window.instgrm.Embeds.process();\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { sanitizeUrl } from \"@library/utility\";\nimport { getData, setData } from \"@library/dom\";\nimport debounce from \"lodash/debounce\";\nimport shave from \"shave\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initLinkEmbeds() {\n    registerEmbedComponent(\"link\", LinkEmbed);\n    truncateEmbedLinks();\n\n    // Retruncate links when the window resizes.\n    window.addEventListener(\"resize\", () => debounce(truncateEmbedLinks, 200)());\n}\n\nexport class LinkEmbed extends BaseEmbed {\n    public render() {\n        const { name, attributes, url, photoUrl, body } = this.props.data;\n        const title = name ? <h3 className=\"embedText-title embedLink-title\">{name}</h3> : null;\n\n        const source = <span className=\"embedLink-source meta\">{url}</span>;\n\n        let linkImage: JSX.Element | null = null;\n        if (photoUrl) {\n            linkImage = <img src={photoUrl} className=\"embedLink-image\" aria-hidden=\"true\" />;\n        }\n        const dateTime =\n            attributes.timestamp && attributes.humanTime ? (\n                <time className=\"embedLink-dateTime meta\" dateTime={attributes.timestamp}>\n                    {attributes.humanTime}\n                </time>\n            ) : null;\n\n        const sanitizedUrl = sanitizeUrl(url);\n        return (\n            <a className=\"embedLink-link\" href={sanitizedUrl} rel=\"noreferrer\">\n                <article className=\"embedText-body embedLink-body\">\n                    {linkImage}\n                    <div className=\"embedText-main embedLink-main\">\n                        <div className=\"embedText-header embedLink-header\">\n                            {title}\n                            {dateTime}\n                            {source}\n                        </div>\n                        <div className=\"embedLink-excerpt\">{body}</div>\n                    </div>\n                </article>\n            </a>\n        );\n    }\n}\n\n/**\n * Truncate embed link excerpts in a container\n *\n * @param container - Element containing embeds to truncate\n */\nexport function truncateEmbedLinks(container = document.body) {\n    const embeds = container.querySelectorAll(\".embedLink-excerpt\");\n    embeds.forEach(el => {\n        let untruncatedText = getData(el, \"untruncatedText\");\n\n        if (!untruncatedText) {\n            untruncatedText = el.innerHTML;\n            setData(el, \"untruncatedText\", untruncatedText);\n        } else {\n            el.innerHTML = untruncatedText;\n        }\n        truncateTextBasedOnMaxHeight(el);\n    });\n}\n\n/**\n * Truncate element text based on max-height\n *\n * @param excerpt - The excerpt to truncate.\n */\nfunction truncateTextBasedOnMaxHeight(excerpt: Element) {\n    const maxHeight = parseInt(getComputedStyle(excerpt)[\"max-height\"], 10);\n    if (maxHeight && maxHeight > 0) {\n        shave(excerpt, maxHeight);\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { registerEmbedComponent } from \"@library/embeds\";\n\nexport function initSoundcloudEmbeds() {\n    registerEmbedComponent(\"soundcloud\", SoundcloudEmbed);\n}\n\nexport class SoundcloudEmbed extends BaseEmbed {\n    public render() {\n        const { attributes } = this.props.data;\n        const { postID, visual, showArtwork, embedUrl } = attributes;\n\n        // Ensure this is a track.\n        if (postID == null) {\n            throw new Error(\"Soundcloud embed fail, the track could not be found\");\n        }\n\n        const url = embedUrl + postID + \"&visual=\" + (visual || \"false\") + \"&show_artwork=\" + (showArtwork || \"false\");\n\n        return <iframe width=\"100%\" scrolling=\"no\" frameBorder=\"no\" src={url} />;\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { ensureScript } from \"@library/dom\";\nimport { onContent } from \"@library/application\";\nimport { IEmbedData, IEmbedElements, registerEmbedRenderer } from \"@library/embeds\";\nimport { IScrapeData } from \"@dashboard/@types/api\";\n\nexport function initTwitterEmbeds() {\n    registerEmbedRenderer(\"twitter\", renderTweet);\n    onContent(convertTwitterEmbeds);\n    void convertTwitterEmbeds().then();\n}\n\n/**\n * Render a single twitter embed.\n */\nexport async function renderTweet(elements: IEmbedElements, data: IScrapeData) {\n    const contentElement = elements.content;\n    // Ensure the twitter library is loaded.\n    await ensureScript(\"//platform.twitter.com/widgets.js\");\n\n    if (!window.twttr) {\n        throw new Error(\"The Twitter widget failed to load.\");\n    }\n\n    // Ensure we have a status id to look up.\n    if (data.attributes.statusID == null) {\n        throw new Error(\"Attempted to embed a tweet but the statusID could not be found\");\n    }\n\n    // Check that we haven't already started to load this embed (In the case multiple onContents are fired off).\n    if (\n        !contentElement.classList.contains(\"js-twitterCardLoaded\") &&\n        !contentElement.classList.contains(\"js-twitterCardPreload\")\n    ) {\n        contentElement.classList.add(\"js-twitterCardPreload\");\n\n        // Render the embed.\n        const options = { conversation: \"none\" };\n        await window.twttr.widgets.createTweet(data.attributes.statusID, contentElement, options);\n        // Remove a url if there is one around.\n        const url = contentElement.querySelector(\".tweet-url\");\n        if (url) {\n            url.remove();\n        }\n\n        // Fade it in.\n        contentElement.classList.add(\"js-twitterCardLoaded\");\n    }\n}\n\n/**\n * Convert all of the twitter embeds in the page. This is for transforming twitter embeds that were\n * server rendered.\n *\n * @see library/Vanilla/Embeds/EmbedManager.php\n */\nexport async function convertTwitterEmbeds() {\n    const tweets = Array.from(document.querySelectorAll(\".js-twitterCard\"));\n    if (tweets.length > 0) {\n        await ensureScript(\"//platform.twitter.com/widgets.js\");\n        if (window.twttr) {\n            const promises = tweets.map(contentElement => {\n                // Get embed data out of the data attributes.\n                const statusID = contentElement.getAttribute(\"data-tweetid\");\n                const url = contentElement.getAttribute(\"data-tweeturl\") || \"\";\n\n                const renderData: IEmbedData = {\n                    type: \"twitter\",\n                    url,\n                    attributes: { statusID },\n                };\n\n                return renderTweet({ content: contentElement as HTMLElement, root: null as any }, renderData);\n            });\n\n            // Render all the pages twitter embeds at the same time.\n            await Promise.all(promises);\n        }\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport BaseEmbed from \"@library/user-content/embeds/BaseEmbed\";\nimport { IEmbedProps, registerEmbedComponent } from \"@library/embeds\";\nimport { simplifyFraction } from \"@library/utility\";\nimport { t } from \"@library/application\";\nimport { delegateEvent } from \"@library/dom\";\nimport ReactDOM from \"react-dom\";\n\nexport function initVideoEmbeds() {\n    registerEmbedComponent(\"youtube\", VideoEmbed);\n    registerEmbedComponent(\"vimeo\", VideoEmbed);\n    registerEmbedComponent(\"twitch\", VideoEmbed);\n    registerEmbedComponent(\"wistia\", VideoEmbed);\n    delegateEvent(\"click\", \".js-playVideo\", handlePlayVideo);\n}\n\ninterface IState {\n    isPlaying: boolean;\n}\n\nexport class VideoEmbed extends BaseEmbed<IEmbedProps, IState> {\n    public constructor(props) {\n        super(props);\n        this.state = {\n            isPlaying: false,\n        };\n    }\n    public render() {\n        const { name, height, width, attributes, photoUrl } = this.props.data;\n        const { embedUrl } = attributes;\n\n        const ratioClass = this.ratioClass;\n        const style: React.CSSProperties = ratioClass\n            ? {}\n            : {\n                  paddingTop: ((height || 3) / (width || 4)) * 100 + \"%\",\n              };\n\n        const thumbnail = (\n            <div className={`embedVideo-ratio ${ratioClass}`} style={style}>\n                <button\n                    type=\"button\"\n                    data-url={embedUrl}\n                    aria-label={name || undefined}\n                    className=\"embedVideo-playButton iconButton\"\n                >\n                    <img\n                        onClick={this.clickHandler}\n                        src={photoUrl || undefined}\n                        role=\"presentation\"\n                        className=\"embedVideo-thumbnail\"\n                    />\n                    <span className=\"embedVideo-scrim\" />\n                    <PlayIcon />\n                </button>\n            </div>\n        );\n\n        return this.state.isPlaying ? <VideoIframe url={embedUrl} /> : thumbnail;\n    }\n\n    private clickHandler = () => {\n        this.setState({ isPlaying: true });\n    };\n\n    private get ratioClass(): string | undefined {\n        const { height, width } = this.props.data;\n        const ratio = simplifyFraction(height || 3, width || 4);\n        switch (ratio.shorthand) {\n            case \"21:9\":\n                return \"is21by9\";\n            case \"16:9\":\n                return \"is16by9\";\n            case \"4:3\":\n                return \"is4by3\";\n            case \"1:1\":\n                return \"is1by1\";\n        }\n    }\n}\n\nfunction VideoIframe(props: { url: string }) {\n    return (\n        <iframe\n            frameBorder=\"0\"\n            allow=\"autoplay; encrypted-media\"\n            className=\"embedVideo-iframe\"\n            src={props.url}\n            allowFullScreen={true}\n        />\n    );\n}\n\nfunction PlayIcon() {\n    const style: React.CSSProperties = { fill: \"currentColor\", strokeWidth: 0.3 };\n\n    return (\n        <svg className=\"embedVideo-playIcon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-1 -1 24 24\">\n            <title>{t(\"Play Video\")}</title>\n            <path\n                className=\"embedVideo-playIconPath embedVideo-playIconPath-circle\"\n                style={style}\n                d=\"M11,0A11,11,0,1,0,22,11,11,11,0,0,0,11,0Zm0,20.308A9.308,9.308,0,1,1,20.308,11,9.308,9.308,0,0,1,11,20.308Z\"\n            />\n            <polygon\n                className=\"embedVideo-playIconPath embedVideo-playIconPath-triangle\"\n                style={style}\n                points=\"8.609 6.696 8.609 15.304 16.261 11 8.609 6.696\"\n            />\n        </svg>\n    );\n}\n\n/**\n * Handle a click on a video.\n */\nfunction handlePlayVideo() {\n    // Inside of delegate event `this` is the current target of the event.\n    const playButton: HTMLElement = this;\n    const container = playButton.closest(\".embedVideo-ratio\");\n    if (container) {\n        const url = playButton.dataset.url as string;\n\n        ReactDOM.render(<VideoIframe url={url} />, container);\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { delegateEvent } from \"@library/dom\";\n\nexport function initSpoilers() {\n    // Setup\n    delegateEvent(\"click\", \".js-toggleSpoiler\", handleToggleSpoiler);\n}\n\n/**\n * Toggle a spoiler open and closed.\n */\nfunction handleToggleSpoiler() {\n    const toggleButton: HTMLElement = this;\n\n    const spoilerContainer = toggleButton.closest(\".spoiler\");\n    if (spoilerContainer) {\n        spoilerContainer.classList.toggle(\"isShowingSpoiler\");\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport debounce from \"lodash/debounce\";\nimport { getElementHeight } from \"@library/dom\";\n\ninterface IProps {\n    id: string;\n    isCollapsed: boolean;\n    preferredMaxHeight: number; // The actual max height could exceed this, but once we pass it stop adding elements.\n    setNeedsCollapser?: (needsCollapser: boolean) => void;\n    dangerouslySetInnerHTML: {\n        __html: string;\n    };\n}\n\ninterface IState {\n    maxHeight: number | string;\n}\n\ninterface IHeightInfo {}\n\n/**\n * A class for dynamic collapsable user content.\n */\nexport default class CollapsableUserContent extends React.PureComponent<IProps, IState> {\n    public state = {\n        maxHeight: \"100%\",\n    };\n    private selfRef: React.RefObject<HTMLDivElement> = React.createRef();\n\n    public render() {\n        const style: React.CSSProperties = { overflow: \"hidden\", maxHeight: this.state.maxHeight };\n\n        return (\n            <div\n                id={this.props.id}\n                className=\"collapsableContent userContent\"\n                style={style}\n                ref={this.selfRef}\n                dangerouslySetInnerHTML={this.props.dangerouslySetInnerHTML}\n            />\n        );\n    }\n\n    /**\n     * Do the initial height calculation and recalcuate if the window dimensions change.\n     */\n    public componentDidMount() {\n        this.calcMaxHeight();\n        window.addEventListener(\"resize\", () =>\n            debounce(() => {\n                this.calcMaxHeight();\n            }, 200)(),\n        );\n    }\n\n    /**\n     * If certain primary props change we need to recalculate the content height.\n     */\n    public componentDidUpdate(prevProps: IProps) {\n        if (\n            prevProps.dangerouslySetInnerHTML.__html !== this.props.dangerouslySetInnerHTML.__html ||\n            prevProps.isCollapsed !== this.props.isCollapsed\n        ) {\n            this.calcMaxHeight();\n        }\n    }\n\n    /**\n     * Calculate the exact pixel max height of the content around the threshold of preferredMaxHeight.\n     */\n    private getHeightInfo(): {\n        height: number | null;\n        needsCollapser: boolean;\n    } {\n        const self = this.selfRef.current;\n\n        if (self === null) {\n            return {\n                height: null,\n                needsCollapser: false,\n            };\n        }\n\n        if (self.childElementCount <= 1) {\n            return {\n                height: null,\n                needsCollapser: false,\n            };\n        }\n\n        let finalMaxHeight = 0;\n        let lastBottomMargin = 0;\n        for (const child of Array.from(self.children)) {\n            if (finalMaxHeight > this.props.preferredMaxHeight) {\n                return {\n                    height: finalMaxHeight,\n                    needsCollapser: true,\n                };\n            }\n\n            const { height, bottomMargin } = getElementHeight(child, lastBottomMargin);\n            if (finalMaxHeight > 0 && height > this.props.preferredMaxHeight) {\n                return {\n                    height: finalMaxHeight,\n                    needsCollapser: true,\n                };\n            }\n            lastBottomMargin = bottomMargin;\n\n            finalMaxHeight += height;\n        }\n\n        return {\n            height: finalMaxHeight,\n            needsCollapser: finalMaxHeight > this.props.preferredMaxHeight,\n        };\n    }\n\n    /**\n     * Calculate the CSS max height that we want to apply to the container div.\n     */\n    private calcMaxHeight() {\n        const { height, needsCollapser } = this.getHeightInfo();\n        if (needsCollapser && this.props.isCollapsed) {\n            this.setState({ maxHeight: height! });\n        } else {\n            this.setState({ maxHeight: this.selfRef.current!.scrollHeight });\n        }\n\n        this.props.setNeedsCollapser && this.props.setNeedsCollapser(needsCollapser);\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { registerEmbedComponent, IEmbedProps, IEmbedData, IQuoteEmbedData } from \"@library/embeds\";\nimport { onContent, t, formatUrl, makeProfileUrl } from \"@library/application\";\nimport CollapsableUserContent from \"@library/user-content/CollapsableContent\";\nimport uniqueId from \"lodash/uniqueId\";\nimport classnames from \"classnames\";\nimport api from \"@library/apiv2\";\n\nexport function initQuoteEmbeds() {\n    registerEmbedComponent(\"quote\", QuoteEmbed as any);\n    onContent(mountQuoteEmbeds);\n}\n\n/**\n * Mount all of the existing quote embeds in the page.\n *\n * Data (including server rendered HTML content should be coming down in JSON encoded attribute data-json).\n */\nexport function mountQuoteEmbeds() {\n    const embeds = document.querySelectorAll(\".js-quoteEmbed\");\n    for (const embed of embeds) {\n        const data = embed.getAttribute(\"data-json\");\n        if (data) {\n            const quoteData = JSON.parse(data) as IEmbedData;\n            const onRenderComplete = () => {\n                embed.removeAttribute(\"data-json\");\n                embed.classList.remove(\"embedResponsive-initialLink\");\n            };\n            ReactDOM.render(\n                <QuoteEmbed data={quoteData} inEditor={false} onRenderComplete={onRenderComplete} />,\n                embed,\n            );\n        }\n    }\n}\n\ninterface IState {\n    isCollapsed: boolean;\n    needsCollapseButton: boolean;\n    renderedBody: string;\n}\n\nfunction ChevronUpIcon() {\n    return (\n        <svg className=\"icon embedQuote-chevronUp\" viewBox=\"0 0 20 20\">\n            <title>{t(\"▲\")}</title>\n            <path\n                fill=\"currentColor\"\n                stroke-linecap=\"square\"\n                fill-rule=\"evenodd\"\n                d=\"M6.79521339,4.1285572 L6.13258979,4.7726082 C6.04408814,4.85847112 6,4.95730046 6,5.0690962 C6,5.18057569 6.04408814,5.27940502 6.13258979,5.36526795 L11.3416605,10.4284924 L6.13275248,15.4915587 C6.04425083,15.5774216 6.00016269,15.6762509 6.00016269,15.7878885 C6.00016269,15.8995261 6.04425083,15.9983555 6.13275248,16.0842184 L6.79537608,16.7282694 C6.88371504,16.8142905 6.98539433,16.8571429 7.10025126,16.8571429 C7.21510819,16.8571429 7.31678748,16.8141323 7.40512644,16.7282694 L13.5818586,10.7248222 C13.6701976,10.6389593 13.7142857,10.54013 13.7142857,10.4284924 C13.7142857,10.3168547 13.6701976,10.2181835 13.5818586,10.1323206 L7.40512644,4.1285572 C7.31678748,4.04269427 7.21510819,4 7.10025126,4 C6.98539433,4 6.88371504,4.04269427 6.79521339,4.1285572 L6.79521339,4.1285572 Z\"\n                transform=\"rotate(-90 9.857 10.429)\"\n            />\n        </svg>\n    );\n}\n\nfunction ChevronDownIcon() {\n    return (\n        <svg className=\"icon embedQuote-chevronDown\" viewBox=\"0 0 20 20\">\n            <title>{t(\"▼\")}</title>\n            <path\n                fill=\"currentColor\"\n                stroke-linecap=\"square\"\n                fill-rule=\"evenodd\"\n                d=\"M6.79521339,4.1285572 L6.13258979,4.7726082 C6.04408814,4.85847112 6,4.95730046 6,5.0690962 C6,5.18057569 6.04408814,5.27940502 6.13258979,5.36526795 L11.3416605,10.4284924 L6.13275248,15.4915587 C6.04425083,15.5774216 6.00016269,15.6762509 6.00016269,15.7878885 C6.00016269,15.8995261 6.04425083,15.9983555 6.13275248,16.0842184 L6.79537608,16.7282694 C6.88371504,16.8142905 6.98539433,16.8571429 7.10025126,16.8571429 C7.21510819,16.8571429 7.31678748,16.8141323 7.40512644,16.7282694 L13.5818586,10.7248222 C13.6701976,10.6389593 13.7142857,10.54013 13.7142857,10.4284924 C13.7142857,10.3168547 13.6701976,10.2181835 13.5818586,10.1323206 L7.40512644,4.1285572 C7.31678748,4.04269427 7.21510819,4 7.10025126,4 C6.98539433,4 6.88371504,4.04269427 6.79521339,4.1285572 L6.79521339,4.1285572 Z\"\n                transform=\"rotate(90 9.857 10.429)\"\n            />\n        </svg>\n    );\n}\n\n/**\n * An embed class for quoted user content on the same site.\n *\n * This is not an editable quote. Instead it an expandable/collapsable snapshot of the quoted/embedded comment/discussion.\n *\n * This can either recieve the post format and body (when created directly in the editor) or be given the fully rendered content (when mounting on top of existing server rendered DOM stuff).\n */\nexport class QuoteEmbed extends React.Component<IEmbedProps<IEmbedData>, IState> {\n    public state: IState = {\n        isCollapsed: true,\n        renderedBody: \"\",\n        needsCollapseButton: false,\n    };\n\n    public render() {\n        const { body, insertUser } = this.quoteData;\n        const id = uniqueId(\"collapsableContent-\");\n\n        const name = (this.quoteData as any).name;\n\n        const title = name ? (\n            <h2 className=\"embedText-title embedQuote-title\">\n                <a href={this.quoteData.url} className=\"embedText-titleLink\">\n                    {name}\n                </a>\n            </h2>\n        ) : null;\n\n        const bodyClasses = classnames(\"embedText-body\", \"embedQuote-body\", { isCollapsed: this.state.isCollapsed });\n        const userUrl = makeProfileUrl(insertUser.name);\n\n        return (\n            <blockquote className={bodyClasses}>\n                <div className=\"embedText-header embedQuote-header\">\n                    {title}\n                    <a href={userUrl} className=\"embedQuote-userLink\">\n                        <span className=\"embedQuote-userPhotoWrap\">\n                            <img\n                                src={insertUser.photoUrl}\n                                alt={insertUser.name}\n                                className=\"embedQuote-userPhoto\"\n                                tabIndex={-1}\n                            />\n                        </span>\n                        <span className=\"embedQuote-userName\">{insertUser.name}</span>\n                    </a>\n                    <a href={this.quoteData.url} className=\"embedQuote-metaLink\">\n                        <time\n                            className=\"embedText-dateTime embedQuote-dateTime meta\"\n                            dateTime={this.dateTime}\n                            title={this.titleTime}\n                        >\n                            {this.humanTime}\n                        </time>\n                    </a>\n\n                    {this.state.needsCollapseButton && (\n                        <button\n                            type=\"button\"\n                            className=\"embedQuote-collapseButton\"\n                            aria-label={t(\"Toggle Quote\")}\n                            onClick={this.toggleCollapseState}\n                            aria-pressed={this.state.isCollapsed}\n                        >\n                            {this.state.isCollapsed ? <ChevronDownIcon /> : <ChevronUpIcon />}\n                        </button>\n                    )}\n                </div>\n                <div className=\"embedText-main embedQuote-main\">\n                    <div className=\"embedQuote-excerpt\">\n                        <CollapsableUserContent\n                            setNeedsCollapser={this.setNeedsCollapser}\n                            isCollapsed={this.state.isCollapsed}\n                            id={id}\n                            preferredMaxHeight={100}\n                            dangerouslySetInnerHTML={{ __html: body ? body : this.state.renderedBody }}\n                        />\n                    </div>\n                </div>\n            </blockquote>\n        );\n    }\n\n    /**\n     * When the component mounts we need to ensure we have rendered post content.\n     *\n     * Either we were passed the content, or we need to make an API call to render it.\n     */\n    public componentDidMount() {\n        if (this.quoteData.body) {\n            this.props.onRenderComplete();\n        } else {\n            const body =\n                this.quoteData.format === \"Rich\" ? JSON.stringify(this.quoteData.bodyRaw) : this.quoteData.bodyRaw;\n            void api\n                .post(\"/rich/quote\", {\n                    body,\n                    format: this.quoteData.format,\n                })\n                .then(response => {\n                    this.setState({ renderedBody: response.data.quote }, this.props.onRenderComplete);\n                });\n        }\n    }\n\n    /**\n     * Callback for the collapser to determine if we need to show the collapse toggle or not.\n     */\n    private setNeedsCollapser = needsCollapser => {\n        this.setState({ needsCollapseButton: needsCollapser });\n    };\n\n    /**\n     * Toggle the state of whether or not we are collapsed.\n     */\n    private toggleCollapseState = (event: React.ChangeEvent<any>) => {\n        event.preventDefault();\n        this.setState({ isCollapsed: !this.state.isCollapsed });\n    };\n\n    /**\n     * Get the quote embed data out of the scrape data.\n     */\n    private get quoteData(): IQuoteEmbedData {\n        return this.props.data.attributes as IQuoteEmbedData;\n    }\n\n    /**\n     * Get the timestamp to display.\n     */\n    private get dateTime(): string {\n        return this.quoteData.dateUpdated || this.quoteData.dateInserted;\n    }\n\n    /**\n     * Get the title of the time tag (long extended date)\n     */\n    private get titleTime(): string {\n        const date = new Date(this.dateTime);\n        return date.toLocaleString(undefined, {\n            year: \"numeric\",\n            month: \"long\",\n            day: \"numeric\",\n            weekday: \"long\",\n            hour: \"numeric\",\n            minute: \"numeric\",\n        });\n    }\n\n    /**\n     * Get a shorter human readable time for the time tag.\n     */\n    private get humanTime(): string {\n        const date = new Date(this.dateTime);\n        return date.toLocaleString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { generateApiActionCreators, ActionsUnion, apiThunk } from \"@library/state/utility\";\nimport { IUserAuthenticator } from \"@dashboard/@types/api\";\n\nexport const GET_USER_AUTHENTICATORS_REQUEST = \"GET_USER_AUTHENTICATORS_REQUEST\";\nexport const GET_USER_AUTHENTICATORS_SUCCESS = \"GET_USER_AUTHENTICATORS_SUCCESS\";\nexport const GET_USER_AUTHENTICATORS_ERROR = \"GET_USER_AUTHENTICATORS_ERROR\";\n\nconst getAuthenticatorsActions = generateApiActionCreators(\n    GET_USER_AUTHENTICATORS_REQUEST,\n    GET_USER_AUTHENTICATORS_SUCCESS,\n    GET_USER_AUTHENTICATORS_ERROR,\n    // https://github.com/Microsoft/TypeScript/issues/10571#issuecomment-345402872\n    {} as IUserAuthenticator[],\n);\n\nexport const getUserAuthenticators = () =>\n    apiThunk(\"get\", \"authenticate/authenticators\", getAuthenticatorsActions, undefined);\n\nexport type ActionTypes = ActionsUnion<typeof getAuthenticatorsActions>;\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport * as actions from \"@dashboard/pages/authenticate/authenticatorsActions\";\nimport { IAuthenticatorState } from \"@dashboard/@types/state\";\nimport { LoadStatus } from \"@library/@types/api\";\n\nconst initialState: IAuthenticatorState = {\n    status: LoadStatus.PENDING,\n};\n\nexport default function authenticatorsReducer(\n    state: IAuthenticatorState = initialState,\n    action: actions.ActionTypes,\n): IAuthenticatorState {\n    switch (action.type) {\n        case actions.GET_USER_AUTHENTICATORS_REQUEST:\n            return {\n                ...state,\n                status: LoadStatus.LOADING,\n            };\n        case actions.GET_USER_AUTHENTICATORS_SUCCESS:\n            return {\n                status: LoadStatus.SUCCESS,\n                data: action.payload.data,\n                error: undefined,\n            };\n        case actions.GET_USER_AUTHENTICATORS_ERROR:\n            return {\n                ...state,\n                status: LoadStatus.ERROR,\n                error: action.payload,\n            };\n        default:\n            return state;\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { generateApiActionCreators, ActionsUnion, apiThunk, createAction } from \"@library/state/utility\";\nimport { IRequestPasswordOptions } from \"@dashboard/@types/api\";\n\n// Authenticating user /authenticate/password\nexport const POST_REQUEST_PASSWORD_REQUEST = \"POST_REQUEST_PASSWORD_REQUEST\";\nexport const POST_REQUEST_PASSWORD_ERROR = \"POST_REQUEST_PASSWORD_ERROR\";\nexport const POST_REQUEST_PASSWORD_SUCCESS = \"POST_REQUEST_PASSWORD_SUCCESS\";\nexport const AFTER_REQUEST_PASSWORD_SUCCESS_NAVIGATE = \"AFTER_REQUEST_PASSWORD_SUCCESS_NAVIGATE\";\n\nexport const afterRequestPasswordSuccessNavigate = () => createAction(AFTER_REQUEST_PASSWORD_SUCCESS_NAVIGATE);\n\nconst otherActions = {\n    afterRequestPasswordSuccessNavigate,\n};\n\nconst requestPasswordActions = generateApiActionCreators(\n    POST_REQUEST_PASSWORD_REQUEST,\n    POST_REQUEST_PASSWORD_SUCCESS,\n    POST_REQUEST_PASSWORD_ERROR,\n    // https://github.com/Microsoft/TypeScript/issues/10571#issuecomment-345402872\n    {},\n    {} as IRequestPasswordOptions,\n);\n\nexport type ActionTypes = ActionsUnion<typeof requestPasswordActions> | ActionsUnion<typeof otherActions>;\n\nexport const postRequestPassword = (params: IRequestPasswordOptions) =>\n    apiThunk(\"post\", \"users/request-password\", requestPasswordActions, params);\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport * as actions from \"@dashboard/pages/recoverPassword/recoverPasswordActions\";\nimport { IRequestPasswordState } from \"@dashboard/@types/state\";\nimport { LoadStatus } from \"@library/@types/api\";\n\nconst initialState: IRequestPasswordState = {\n    status: LoadStatus.PENDING,\n};\n\nexport default function passwordReducer(\n    state: IRequestPasswordState = initialState,\n    action: actions.ActionTypes,\n): IRequestPasswordState {\n    switch (action.type) {\n        case actions.POST_REQUEST_PASSWORD_REQUEST:\n            return {\n                ...state,\n                status: LoadStatus.LOADING,\n            };\n        case actions.POST_REQUEST_PASSWORD_SUCCESS:\n            return {\n                status: LoadStatus.SUCCESS,\n                data: action.payload.data,\n                error: undefined,\n            };\n        case actions.POST_REQUEST_PASSWORD_ERROR:\n            return {\n                ...state,\n                status: LoadStatus.ERROR,\n                error: action.payload,\n            };\n        case actions.AFTER_REQUEST_PASSWORD_SUCCESS_NAVIGATE:\n            return initialState;\n        default:\n            return state;\n    }\n}\n","/**\n * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { combineReducers } from \"redux\";\nimport authenticatorsReducer from \"@dashboard/pages/authenticate/authenticatorsReducer\";\nimport passwordReducer from \"@dashboard/pages/recoverPassword/recoverPasswordReducer\";\n\nconst authenticateReducer = combineReducers({\n    authenticators: authenticatorsReducer,\n    password: passwordReducer,\n});\n\nexport default authenticateReducer;\n","/**\n * @author Adam (charrondev) Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { combineReducers } from \"redux\";\nimport requestPasswordReducer from \"@dashboard/pages/recoverPassword/recoverPasswordReducer\";\n\nconst usersReducer = combineReducers({\n    requestPassword: requestPasswordReducer,\n});\n\nexport default usersReducer;\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { t } from \"@library/application\";\n\ninterface IProps {\n    visible: boolean;\n}\n\nexport default class Or extends React.PureComponent<IProps, {}> {\n    public static defaultProps: IProps = {\n        visible: true,\n    };\n\n    public render() {\n        return this.props.visible ? (\n            <div className=\"inputBlock-labelText authenticateUser-divider\">{t(\"or\")}</div>\n        ) : null;\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { getOptionalID, IOptionalComponentID } from \"@library/componentIDs\";\n\ninterface IProps extends IOptionalComponentID {\n    className?: string;\n    isError?: boolean;\n    content?: React.ReactNode;\n}\n\nexport default class Paragraph extends React.Component<IProps> {\n    public static defaultProps = {\n        id: false,\n    };\n\n    public id: string;\n\n    constructor(props) {\n        super(props);\n        this.id = getOptionalID(props, \"Paragraph\") as string;\n    }\n\n    public render() {\n        if (this.props.content) {\n            const componentClasses = classNames({ isError: this.props.isError }, this.props.className);\n\n            let accessibilityProps = {};\n\n            if (this.props.isError) {\n                accessibilityProps = {\n                    \"aria-live\": \"assertive\",\n                    role: \"alert\",\n                };\n            }\n\n            return (\n                <p id={this.id} className={componentClasses} {...accessibilityProps}>\n                    {this.props.content}\n                </p>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { t } from \"@library/application\";\nimport React from \"react\";\nimport Paragraph from \"@dashboard/components/forms/Paragraph\";\nimport { IUserAuthenticator } from \"@dashboard/@types/api\";\n\ninterface IProps {\n    ssoMethods?: IUserAuthenticator[];\n}\n\nexport default class SSOMethods extends React.Component<IProps> {\n    public render() {\n        if (!this.props.ssoMethods || this.props.ssoMethods.length === 0) {\n            return null;\n        }\n\n        const ssoMethods = this.props.ssoMethods.map((method, index) => {\n            const methodStyles = {\n                backgroundColor: method.ui.backgroundColor || undefined,\n                color: method.ui.foregroundColor || undefined,\n            };\n            return (\n                <a\n                    href={method.ui.url}\n                    key={index}\n                    className=\"BigButton button Button button-sso button-fullWidth\"\n                    style={methodStyles}\n                >\n                    <span className=\"button-ssoContents\">\n                        <img src={method.ui.photoUrl || undefined} className=\"ssoMethod-icon\" aria-hidden={true} />\n                        <span className=\"button-ssoLabel\">{t(method.ui.buttonName)}</span>\n                        <span className=\"ssoMethod-icon ssoMethod-iconSpacer\" aria-hidden=\"true\" />\n                    </span>\n                </a>\n            );\n        });\n\n        return (\n            <div className=\"ssoMethods\">\n                <Paragraph content={t(\"Sign in with one of the following:\")} />\n                {ssoMethods}\n            </div>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { getRequiredID, IRequiredComponentID } from \"@library/componentIDs\";\nimport { IFieldError } from \"@library/@types/api\";\n\ninterface IProps extends IRequiredComponentID {\n    className?: string;\n    errors?: IFieldError[];\n}\n\ninterface IState {\n    id: string;\n}\n\nexport default class ErrorMessages extends React.Component<IProps, IState> {\n    constructor(props) {\n        super(props);\n        this.state = {\n            id: getRequiredID(props, \"errorMessages\") as string,\n        };\n    }\n\n    public render() {\n        const { errors } = this.props;\n\n        if (errors && errors.length > 0) {\n            const componentClasses = classNames(\"inputBlock-errors\", this.props.className);\n\n            const errorList = (errors as any).map((error: any, index) => {\n                return (\n                    <span key={index} className=\"inputBlock-error\">\n                        {error.message}\n                    </span>\n                );\n            });\n\n            return (\n                <span id={this.state.id} className={componentClasses}>\n                    {errorList}\n                </span>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { getRequiredID, IOptionalComponentID } from \"@library/componentIDs\";\nimport { IFieldError } from \"@library/@types/api\";\nimport Paragraph from \"@dashboard/components/forms/Paragraph\";\nimport ErrorMessages from \"@dashboard/components/forms/ErrorMessages\";\n\nexport interface IInputTextProps extends IOptionalComponentID {\n    className?: string;\n    label: string;\n    value: string;\n    onChange: (event: React.ChangeEvent<HTMLInputElement>) => void;\n    labelNote?: string;\n    inputClassNames?: string;\n    type?: string;\n    labelID?: string;\n    defaultValue?: string;\n    placeholder?: string;\n    valid?: boolean;\n    descriptionID?: string;\n    required?: boolean;\n    errors?: IFieldError[];\n    disabled?: boolean;\n}\n\ninterface IState {\n    id: string;\n}\n\nexport default class InputTextBlock extends React.Component<IInputTextProps, IState> {\n    public static defaultProps = {\n        disabled: false,\n        type: \"text\",\n        errors: [],\n    };\n\n    private inputRef: React.RefObject<HTMLInputElement> = React.createRef();\n\n    public constructor(props) {\n        super(props);\n        this.state = {\n            id: getRequiredID(props, \"inputText\") as string,\n        };\n    }\n\n    public render() {\n        const componentClasses = classNames(\"inputBlock\", this.props.className);\n        const inputClasses = classNames(\"inputBlock-inputText\", \"InputBox\", \"inputText\", this.props.inputClassNames);\n        const hasErrors = !!this.props.errors && this.props.errors.length > 0;\n\n        let describedBy;\n        if (hasErrors) {\n            describedBy = this.errorID;\n        }\n\n        return (\n            <label className={componentClasses}>\n                <span id={this.labelID} className=\"inputBlock-labelAndDescription\">\n                    <span className=\"inputBlock-labelText\">{this.props.label}</span>\n                    <Paragraph id={false} className=\"inputBlock-labelNote\" content={this.props.labelNote} />\n                </span>\n\n                <span className=\"inputBlock-inputWrap\">\n                    <input\n                        id={this.state.id}\n                        className={inputClasses}\n                        defaultValue={this.props.defaultValue}\n                        value={this.props.value}\n                        type={this.props.type}\n                        disabled={this.props.disabled}\n                        required={this.props.required}\n                        placeholder={this.props.placeholder}\n                        aria-invalid={hasErrors}\n                        aria-describedby={describedBy}\n                        aria-labelledby={this.labelID}\n                        onChange={this.onChange}\n                        ref={this.inputRef}\n                    />\n                </span>\n                <ErrorMessages id={this.errorID} errors={this.props.errors} />\n            </label>\n        );\n    }\n\n    /**\n     * Use a native change event instead of React's because of https://github.com/facebook/react/issues/1159\n     */\n    public componentDidMount() {\n        this.inputRef.current!.addEventListener(\"change\", this.onChange);\n    }\n\n    /**\n     * Use a native change event instead of React's because of https://github.com/facebook/react/issues/1159\n     */\n    public componentWillUnount() {\n        this.inputRef.current!.removeEventListener(\"change\", this.onChange);\n    }\n\n    public get value(): any {\n        return this.inputRef.current ? this.inputRef.current.value : \"\";\n    }\n\n    public set value(value) {\n        if (this.inputRef.current) {\n            this.inputRef.current.value = value;\n        } else {\n            throw new Error(\"inputDom does not exist\");\n        }\n    }\n\n    public focus() {\n        this.inputRef.current!.focus();\n    }\n\n    public select() {\n        this.inputRef.current!.select();\n    }\n\n    private onChange = event => {\n        if (this.props.onChange) {\n            this.props.onChange(event);\n        }\n    };\n\n    private get labelID(): string {\n        return this.state.id + \"-label\";\n    }\n\n    private get errorID(): string {\n        return this.state.id + \"-errors\";\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { t } from \"@library/application\";\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { getOptionalID, IOptionalComponentID } from \"@library/componentIDs\";\n\ninterface IProps extends IOptionalComponentID {\n    id?: string;\n    className?: string;\n    checked: boolean;\n    disabled?: boolean;\n    onChange: any;\n    label: string;\n}\n\ninterface IState {\n    id: string;\n}\n\nexport default class Button extends React.Component<IProps, IState> {\n    public static defaultProps = {\n        disabled: false,\n        id: false,\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            id: getOptionalID(props, \"checkbox\") as string,\n        };\n    }\n\n    get labelID(): string {\n        return this.state.id + \"-label\";\n    }\n\n    public render() {\n        const componentClasses = classNames(\"checkbox\", this.props.className);\n\n        return (\n            <label id={this.state.id} className={componentClasses}>\n                <input\n                    className=\"checkbox-input\"\n                    aria-labelledby={this.labelID}\n                    type=\"checkbox\"\n                    onChange={this.props.onChange}\n                    checked={this.props.checked}\n                />\n                <span className=\"checkbox-box\" aria-hidden=\"true\">\n                    <span className=\"checkbox-state\">\n                        <svg\n                            className=\"checkbox-icon checkbox-checkIcon\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                            viewBox=\"0 0 10 10\"\n                        >\n                            <title>{t(\"✓\")}</title>\n                            <path\n                                fill=\"currentColor\"\n                                d=\"M10,2.7c0-0.2-0.1-0.3-0.2-0.4L8.9,1.3c-0.2-0.2-0.6-0.2-0.9,0L3.8,5.6L1.9,3.7c-0.2-0.2-0.6-0.2-0.9,0L0.2,4.6c-0.2,0.2-0.2,0.6,0,0.9l3.2,3.2c0.2,0.2,0.6,0.2,0.9,0l5.5-5.5C9.9,3,10,2.8,10,2.7z\"\n                            />\n                        </svg>\n                    </span>\n                </span>\n                <span id={this.labelID} className=\"checkbox-label\">\n                    {this.props.label}\n                </span>\n            </label>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { getOptionalID, IOptionalComponentID } from \"@library/componentIDs\";\n\ninterface IProps extends IOptionalComponentID {\n    className?: string;\n    type: string;\n    content: string | Node;\n    disabled?: boolean;\n    prefix: string;\n}\n\ninterface IState {\n    id?: string;\n}\n\nexport default class Button extends React.Component<IProps, IState> {\n    public static defaultProps = {\n        id: false,\n        disabled: false,\n        type: \"button\",\n        prefix: \"button\",\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            id: getOptionalID(props, props.prefix) as string | undefined,\n        };\n    }\n\n    public render() {\n        const componentClasses = classNames(\"button\", \"Button\", this.props.className);\n\n        return (\n            <button\n                id={this.state.id}\n                disabled={this.props.disabled}\n                type={this.props.type}\n                className={componentClasses}\n            >\n                {this.props.content}\n            </button>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport classNames from \"classnames\";\nimport { IOptionalComponentID } from \"@library/componentIDs\";\nimport Button from \"@dashboard/components/forms/Button\";\n\ninterface IProps extends IOptionalComponentID {\n    content: string | Node;\n    className?: string;\n    disabled?: boolean;\n}\n\nexport default class ButtonSubmit extends React.Component<IProps, IOptionalComponentID> {\n    public static defaultProps = {\n        disabled: false,\n    };\n\n    constructor(props) {\n        super(props);\n    }\n\n    public render() {\n        const componentClasses = classNames(\n            \"Primary\",\n            \"buttonCTA\",\n            \"BigButton\",\n            \"button-fullWidth\",\n            this.props.className,\n        );\n\n        return (\n            <Button\n                id={this.props.id}\n                disabled={this.props.disabled}\n                type=\"submit\"\n                content={this.props.content}\n                className={componentClasses}\n                prefix=\"submitButton\"\n            >\n                {this.props.content}\n            </Button>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { generateApiActionCreators, ActionsUnion, apiThunk } from \"@library/state/utility\";\nimport { IAuthenticatePasswordResponseData, IAuthenticatePasswordParams } from \"@dashboard/@types/api\";\nimport apiv2 from \"@library/apiv2\";\nimport { AxiosResponse, AxiosError } from \"axios\";\nimport { formatUrl } from \"@library/application\";\n\n// Authenticating user /authenticate/password\nexport const POST_AUTHENTICATE_PASSWORD_REQUEST = \"POST_AUTHENTICATE_PASSWORD_REQUEST\";\nexport const POST_AUTHENTICATE_PASSWORD_ERROR = \"POST_AUTHENTICATE_PASSWORD_ERROR\";\nexport const POST_AUTHENTICATE_PASSWORD_SUCCESS = \"POST_AUTHENTICATE_PASSWORD_SUCCESS\";\n\nconst authenticatePasswordActions = generateApiActionCreators(\n    POST_AUTHENTICATE_PASSWORD_REQUEST,\n    POST_AUTHENTICATE_PASSWORD_SUCCESS,\n    POST_AUTHENTICATE_PASSWORD_ERROR,\n    // https://github.com/Microsoft/TypeScript/issues/10571#issuecomment-345402872\n    {} as IAuthenticatePasswordResponseData,\n    {} as IAuthenticatePasswordParams,\n);\n\nexport const postAuthenticatePassword = (params: IAuthenticatePasswordParams) => dispatch => {\n    dispatch(authenticatePasswordActions.request(params));\n    apiv2\n        .post(\"/authenticate/password\", params)\n        .then((response: AxiosResponse) => {\n            dispatch(authenticatePasswordActions.success(response, params));\n            const urlParms = new URLSearchParams();\n            window.location.href = formatUrl(urlParms.get(\"target\") || \"/\");\n        })\n        .catch((axiosError: AxiosError) => {\n            const error = axiosError.response ? axiosError.response.data : (axiosError as any);\n            dispatch(authenticatePasswordActions.error(error));\n        });\n};\n\nexport type ActionTypes = ActionsUnion<typeof authenticatePasswordActions>;\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { getFieldErrors, getGlobalErrorMessage } from \"@library/apiv2\";\nimport { t } from \"@library/application\";\nimport React from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport InputTextBlock from \"@dashboard/components/forms/InputTextBlock\";\nimport Checkbox from \"@dashboard/components/forms/Checkbox\";\nimport ButtonSubmit from \"@dashboard/components/forms/ButtonSubmit\";\nimport Paragraph from \"@dashboard/components/forms/Paragraph\";\nimport { IRequiredComponentID, getRequiredID } from \"@library/componentIDs\";\nimport { IStoreState, IPasswordState } from \"@dashboard/@types/state\";\nimport { IAuthenticatePasswordParams } from \"@dashboard/@types/api\";\nimport { connect } from \"react-redux\";\nimport { LoadStatus } from \"@library/@types/api\";\nimport { postAuthenticatePassword } from \"@dashboard/pages/authenticate/passwordActions\";\n\ninterface IProps {\n    passwordState: IPasswordState;\n    authenticate: typeof postAuthenticatePassword;\n    defaultUsername?: string;\n}\n\ninterface IState extends IRequiredComponentID {\n    rememberMe: boolean;\n    username: string;\n    password: string;\n    id: string;\n}\n\n/**\n * Username + password from for signins.\n */\nexport class PasswordForm extends React.Component<IProps, IState> {\n    private usernameInput: React.RefObject<InputTextBlock> = React.createRef();\n    private passwordInput: React.RefObject<InputTextBlock> = React.createRef();\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            id: getRequiredID(props, \"passwordForm\"),\n            rememberMe: true,\n            username: \"\",\n            password: \"\",\n        };\n    }\n\n    public render() {\n        let formDescribedBy;\n        const globalErrorMessage = getGlobalErrorMessage(this.props.passwordState, [\"username\", \"password\"]);\n        if (globalErrorMessage) {\n            formDescribedBy = this.formDescriptionID;\n        }\n\n        return (\n            <form\n                id={this.state.id}\n                aria-describedby={formDescribedBy}\n                className=\"passwordForm\"\n                method=\"post\"\n                onSubmit={this.handleSubmit}\n                noValidate\n            >\n                <Paragraph\n                    id={this.formDescriptionID}\n                    className=\"authenticateUser-paragraph\"\n                    content={globalErrorMessage}\n                    isError={true}\n                />\n                <InputTextBlock\n                    label={t(\"Email/Username\")}\n                    required={true}\n                    disabled={!this.allowEdit}\n                    errors={getFieldErrors(this.props.passwordState, \"username\")}\n                    defaultValue={this.props.defaultUsername || \"\"}\n                    ref={this.usernameInput}\n                    onChange={this.handleUsernameChange}\n                    value={this.state.username}\n                />\n                <InputTextBlock\n                    label={t(\"Password\")}\n                    required={true}\n                    disabled={!this.allowEdit}\n                    errors={getFieldErrors(this.props.passwordState, \"password\")}\n                    type=\"password\"\n                    ref={this.passwordInput}\n                    onChange={this.handlePasswordChange}\n                    value={this.state.password}\n                />\n                <div className=\"inputBlock inputBlock-tighter\">\n                    <div className=\"rememberMeAndForgot\">\n                        <span className=\"rememberMeAndForgot-rememberMe\">\n                            <Checkbox\n                                label={t(\"Keep me signed in\")}\n                                onChange={this.handleCheckBoxChange}\n                                checked={this.state.rememberMe}\n                            />\n                        </span>\n                        <span className=\"rememberMeAndForgot-forgot\">\n                            <Link to=\"/authenticate/recoverpassword\">{t(\"Forgot your password?\")}</Link>\n                        </span>\n                    </div>\n                </div>\n                <ButtonSubmit disabled={!this.allowSubmit} content={t(\"Sign In\")} />\n            </form>\n        );\n    }\n\n    /**\n     * Whenever the component gets new form state, we check for errors and focus the relavent errored inputs.\n     */\n    public componentDidUpdate(prevProps: IProps) {\n        if (this.props.passwordState === prevProps.passwordState) {\n            return;\n        }\n\n        if (getFieldErrors(this.props.passwordState, \"username\")) {\n            this.usernameInput.current!.select();\n        } else if (getFieldErrors(this.props.passwordState, \"password\")) {\n            this.passwordInput.current!.select();\n        } else {\n            this.usernameInput.current!.select();\n        }\n    }\n\n    /**\n     * Whether or not inputs in the form can be edited.\n     */\n    private get allowEdit() {\n        return this.props.passwordState.status !== LoadStatus.LOADING;\n    }\n\n    private get allowSubmit() {\n        const { username, password } = this.state;\n        return username.length > 0 && password.length > 0;\n    }\n\n    /**\n     * Handler for the remember me checkbox.\n     */\n    private handleCheckBoxChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        this.setState({ rememberMe: event.target.checked || false });\n    };\n\n    /**\n     * Change handler for the email input.\n     */\n    private handleUsernameChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const { value } = event.target;\n        this.setState({ username: value });\n    };\n\n    /**\n     * Change handler for the email input.\n     */\n    private handlePasswordChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const { value } = event.target;\n        this.setState({ password: value });\n    };\n\n    /**\n     * Submit handler for the form.\n     */\n    private handleSubmit = (event: React.SyntheticEvent<any>) => {\n        event.preventDefault();\n        const { username, password, rememberMe } = this.state;\n\n        this.props.authenticate({\n            username,\n            password,\n            persist: rememberMe,\n        });\n    };\n\n    /**\n     * Get the description ID for the form.\n     */\n    private get formDescriptionID() {\n        return this.state.id + \"-description\";\n    }\n}\n\nfunction mapStateToProps({ authenticate }: IStoreState) {\n    return {\n        passwordState: authenticate.password,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        authenticate: (params: IAuthenticatePasswordParams) => {\n            dispatch(postAuthenticatePassword(params));\n        },\n    };\n}\n\nconst withRedux = connect(\n    mapStateToProps,\n    mapDispatchToProps,\n);\nexport default withRedux(withRouter(PasswordForm));\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { t } from \"@library/application\";\nimport { LoadStatus } from \"@library/@types/api\";\nimport { getRequiredID, IRequiredComponentID } from \"@library/componentIDs\";\nimport DocumentTitle from \"@library/components/DocumentTitle\";\nimport Or from \"@dashboard/components/forms/Or\";\nimport { IStoreState, IAuthenticatorState } from \"@dashboard/@types/state\";\nimport { getUserAuthenticators } from \"@dashboard/pages/authenticate/authenticatorsActions\";\nimport SSOMethods from \"@dashboard/pages/authenticate/components/SSOMethods\";\nimport PasswordForm from \"@dashboard/pages/authenticate/components/PasswordForm\";\n\ninterface IProps {\n    authenticatorState: IAuthenticatorState;\n    loadAuthenticators: typeof getUserAuthenticators;\n}\n\nexport class SignInPage extends React.Component<IProps, IRequiredComponentID> {\n    public pageTitleID: string;\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            id: getRequiredID(props, \"SignInPage\"),\n        };\n    }\n\n    get titleID(): string {\n        return this.state.id + \"-pageTitle\";\n    }\n\n    public componentDidMount() {\n        if (this.props.authenticatorState.status === LoadStatus.PENDING) {\n            this.props.loadAuthenticators();\n        }\n    }\n\n    public render() {\n        const { authenticatorState } = this.props;\n\n        if (authenticatorState.status !== LoadStatus.SUCCESS) {\n            // TODO: Use a generic fallback component for the other states.\n            return null;\n        }\n\n        let showPassword = false;\n        const ssoMethods = authenticatorState.data.filter(a => {\n            if (a.type === \"password\") {\n                showPassword = true;\n                return false;\n            }\n            return true;\n        });\n\n        return (\n            <div id={this.state.id} className=\"authenticateUserCol\">\n                <DocumentTitle title={t(\"Sign In\")}>\n                    <h1 id={this.titleID} className=\"isCentered\">\n                        {t(\"Sign In\")}\n                    </h1>\n                </DocumentTitle>\n                <SSOMethods ssoMethods={ssoMethods} />\n                <Or visible={showPassword && ssoMethods.length > 0} />\n                {showPassword && <PasswordForm />}\n            </div>\n        );\n    }\n}\n\nfunction mapStateToProps({ authenticate }: IStoreState) {\n    return {\n        authenticatorState: authenticate.authenticators,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        loadAuthenticators: () => {\n            dispatch(getUserAuthenticators());\n        },\n    };\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps,\n)(SignInPage);\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport * as React from \"react\";\nimport { t } from \"@library/application\";\nimport { uniqueIDFromPrefix } from \"@library/componentIDs\";\nimport DocumentTitle from \"@library/components/DocumentTitle\";\nimport PasswordForm from \"@dashboard/pages/authenticate/components/PasswordForm\";\n\nexport default class PasswordPage extends React.Component {\n    private id = uniqueIDFromPrefix(\"PasswordPage\");\n\n    get titleID(): string {\n        return this.id + \"-pageTitle\";\n    }\n\n    public render() {\n        return (\n            <div className=\"authenticateUserCol\">\n                <DocumentTitle title={t(\"Sign In\")}>\n                    <h1 id={this.titleID} className=\"isCentered\">\n                        {t(\"Sign In\")}\n                    </h1>\n                </DocumentTitle>\n                <PasswordForm />\n            </div>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { t } from \"@library/application\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\n\ninterface IProps {\n    onClick?: () => void;\n}\n\nexport default class RememberPasswordLink extends React.Component<IProps> {\n    public render() {\n        return (\n            <p className=\"authenticateUser-paragraph isCentered\">\n                {t(\"Remember your password?\")}{\" \"}\n                <Link onClick={this.props.onClick} to=\"/authenticate/signin\">\n                    {t(\"Sign In\")}\n                </Link>\n            </p>\n        );\n    }\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { getFieldErrors, getGlobalErrorMessage } from \"@library/apiv2\";\nimport { LoadStatus } from \"@library/@types/api\";\nimport { t } from \"@library/application\";\nimport DocumentTitle from \"@library/components/DocumentTitle\";\nimport React from \"react\";\nimport ButtonSubmit from \"@dashboard/components/forms/ButtonSubmit\";\nimport Paragraph from \"@dashboard/components/forms/Paragraph\";\nimport InputTextBlock from \"@dashboard/components/forms/InputTextBlock\";\nimport uniqueId from \"lodash/uniqueId\";\nimport { IStoreState, IRequestPasswordState } from \"@dashboard/@types/state\";\nimport { IRequestPasswordOptions } from \"@dashboard/@types/api\";\nimport { connect } from \"react-redux\";\nimport {\n    postRequestPassword,\n    afterRequestPasswordSuccessNavigate,\n} from \"@dashboard/pages/recoverPassword/recoverPasswordActions\";\nimport RememberPasswordLink from \"@dashboard/pages/authenticate/components/RememberPasswordLink\";\n\ninterface IState {\n    email: string;\n}\n\ninterface IProps {\n    requestPasswordState: IRequestPasswordState;\n    postRequestPassword: typeof postRequestPassword;\n    onNavigateAway: () => void;\n}\n\nexport class RecoverPasswordPage extends React.Component<IProps, IState> {\n    public id = uniqueId(\"RecoverPasswordPage\");\n    public pageTitleID: string;\n    public emainInput: React.RefObject<InputTextBlock> = React.createRef();\n\n    constructor(props) {\n        super(props);\n        this.id = this.pageTitleID = this.id + \"-pageTitle\";\n\n        this.state = {\n            email: \"\",\n        };\n    }\n\n    public render() {\n        const pageTitle = (\n            <DocumentTitle title={t(\"Recover Password\")}>\n                <h1 id={this.pageTitleID} className=\"isCentered\">\n                    {t(\"Recover Password\")}\n                </h1>\n            </DocumentTitle>\n        );\n\n        if (this.props.requestPasswordState.status === LoadStatus.SUCCESS) {\n            return (\n                <div id={this.id} className=\"authenticateUserCol\">\n                    {pageTitle}\n                    <Paragraph\n                        content={t(\"A message has been sent to your email address with password reset instructions.\")}\n                        className=\"authenticateUser-paragraph\"\n                    />\n                    <RememberPasswordLink onClick={this.props.onNavigateAway} />\n                </div>\n            );\n        } else {\n            return (\n                <div className=\"authenticateUserCol\">\n                    {pageTitle}\n                    <Paragraph\n                        content={t(\"RecoverPasswordLabelCode\", \"Enter your email to continue.\")}\n                        className=\"authenticateUser-paragraph\"\n                    />\n                    <form id={this.id} onSubmit={this.handleSubmit} aria-labelledby={this.pageTitleID} noValidate>\n                        <Paragraph\n                            className=\"authenticateUser-paragraph\"\n                            content={getGlobalErrorMessage(this.props.requestPasswordState, [\"email\"])}\n                            isError={true}\n                        />\n                        <InputTextBlock\n                            label={t(\"Email\")}\n                            required={true}\n                            disabled={!this.allowEdit}\n                            errors={getFieldErrors(this.props.requestPasswordState, \"email\")}\n                            value={this.state.email}\n                            onChange={this.handleEmailChange}\n                            ref={this.emainInput}\n                        />\n                        <ButtonSubmit\n                            disabled={!this.allowEdit || this.state.email.length === 0}\n                            content={t(\"Request a new password\")}\n                        />\n                    </form>\n                    <RememberPasswordLink />\n                </div>\n            );\n        }\n    }\n\n    /**\n     * Whenever the component gets new form state, we check for errors and focus the relavent errored inputs.\n     */\n    public componentDidUpdate(prevProps: IProps) {\n        if (this.props.requestPasswordState === prevProps.requestPasswordState) {\n            return;\n        }\n        if (this.props.requestPasswordState.status === LoadStatus.ERROR) {\n            this.emainInput.current!.select();\n        }\n    }\n\n    /**\n     * Change handler for the email input.\n     */\n    private handleEmailChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const { value } = event.target;\n        this.setState({ email: value });\n    };\n\n    /**\n     * Submit handler for the form.\n     */\n    private handleSubmit = event => {\n        event.preventDefault();\n        const { email } = this.state;\n        this.props.postRequestPassword({ email });\n    };\n\n    /**\n     * Whether or not the user can edit elements in the form.\n     */\n    private get allowEdit() {\n        return this.props.requestPasswordState.status !== LoadStatus.LOADING;\n    }\n}\n\nfunction mapStateToProps({ users }: IStoreState) {\n    return {\n        requestPasswordState: users.requestPassword,\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        postRequestPassword: (params: IRequestPasswordOptions) => {\n            dispatch(postRequestPassword(params));\n        },\n        onNavigateAway: () => {\n            dispatch(afterRequestPasswordSuccessNavigate());\n        },\n    };\n}\n\nconst withRedux = connect(\n    mapStateToProps,\n    mapDispatchToProps,\n);\n\nexport default withRedux(RecoverPasswordPage);\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { onReady, onContent } from \"@library/application\";\nimport { convertToSafeEmojiCharacters } from \"@library/dom\";\n\nexport function initEmojiSupport() {\n    // Emoji\n    onReady(() => convertToSafeEmojiCharacters(document.body));\n    onContent(() => convertToSafeEmojiCharacters(document.body));\n}\n","/**\n * Wire together the different parts of the application.\n *\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { initCodePenEmbeds } from \"@library/user-content/embeds/codepen\";\nimport { initGettyEmbeds, convertGettyEmbeds } from \"@library/user-content/embeds/getty\";\nimport { initGiphyEmbeds } from \"@library/user-content/embeds/giphy\";\nimport { initImageEmbeds } from \"@library/user-content/embeds/image\";\nimport { initImgurEmbeds, convertImgurEmbeds } from \"@library/user-content/embeds/imgur\";\nimport { initInstagramEmbeds, convertInstagramEmbeds } from \"@library/user-content/embeds/instagram\";\nimport { initLinkEmbeds } from \"@library/user-content/embeds/link\";\nimport { initSoundcloudEmbeds } from \"@library/user-content/embeds/soundcloud\";\nimport { initTwitterEmbeds, convertTwitterEmbeds } from \"@library/user-content/embeds/twitter\";\nimport { initVideoEmbeds } from \"@library/user-content/embeds/video\";\nimport { initEmojiSupport } from \"@library/user-content/emoji\";\nimport { initSpoilers } from \"@library/user-content/spoilers\";\nimport { initQuoteEmbeds, mountQuoteEmbeds } from \"@library/user-content/embeds/quote\";\n\nexport function initAllUserContent() {\n    // User content\n    initEmojiSupport();\n    initSpoilers();\n    initCodePenEmbeds();\n    initGettyEmbeds();\n    initGiphyEmbeds();\n    initImageEmbeds();\n    initImgurEmbeds();\n    initInstagramEmbeds();\n    initLinkEmbeds();\n    initSoundcloudEmbeds();\n    initTwitterEmbeds();\n    initVideoEmbeds();\n    initQuoteEmbeds();\n}\n\n/**\n * Runs method for all embeds that need to be rendered everytime content changes.\n * This is ideal for something like react's `componentDidMount`.\n */\nexport function convertAllUserContent() {\n    void convertGettyEmbeds();\n    void convertImgurEmbeds();\n    void convertInstagramEmbeds();\n    void convertTwitterEmbeds();\n    void mountQuoteEmbeds();\n}\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { addRoutes, addComponent, onReady } from \"@library/application\";\nimport React from \"react\";\nimport { Route } from \"react-router-dom\";\nimport Router from \"@dashboard/components/Router\";\nimport { stickyHeader } from \"@library/dom\";\nimport { registerReducer } from \"@library/state/reducerRegistry\";\n\ninitAllUserContent();\n\n// Redux\nregisterReducer(\"authenticate\", authenticateReducer);\nregisterReducer(\"users\", usersReducer);\n\n// Routing\naddComponent(\"App\", Router);\naddRoutes([\n    <Route exact path=\"/authenticate/signin\" component={SignInPage} />,\n    <Route exact path=\"/authenticate/password\" component={PasswordPage} />,\n    <Route exact path=\"/authenticate/recoverpassword\" component={RecoverPasswordPage} />,\n]);\n\n// Other site initializations\nonReady(() => {\n    stickyHeader();\n});\n\n// The forum section needs these legacy scripts that have been moved into the bundled JS so it could be refactored.\n// Other sections should not need this yet.\nimport \"@dashboard/legacy\";\nimport { initAllUserContent } from \"@library/user-content\";\nimport authenticateReducer from \"@dashboard/pages/authenticate/authenticateReducer\";\nimport usersReducer from \"@dashboard/usersReducer\";\nimport SignInPage from \"@dashboard/pages/authenticate/SignInPage\";\nimport PasswordPage from \"@dashboard/pages/authenticate/PasswordPage\";\nimport RecoverPasswordPage from \"@dashboard/pages/recoverPassword/RecoverPasswordPage\";\n","/**\n * Set wepback's public path.\n * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot\n * Eg. installed in a subfolder / using Reverse Proxy.\n *\n * @author Adam Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { assetUrl } from \"@library/application\";\n\n/**\n * This needs to be a free variable.\n *\n * Webpack does some magic to make this work.\n * It you try and set a local or global version of it, it WILL NOT work.\n *\n * @see https://stackoverflow.com/questions/12934929/what-are-free-variables\n * @see https://webpack.js.org/configuration/output/#output-publicpath\n * @see https://github.com/webpack/webpack/issues/2776#issuecomment-233208623\n */\n// @ts-ignore: Cannot find variable warning. See comment aboe.\n__webpack_public_path__ = assetUrl(\"/\");\n","/**\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { IEmbedData, IEmbedElements, registerEmbedRenderer } from \"@library/embeds\";\nimport { ensureScript } from \"@library/dom\";\nimport { onContent, onReady } from \"@library/application\";\nimport { IScrapeData } from \"@dashboard/@types/api\";\n\nexport function initGettyEmbeds() {\n    registerEmbedRenderer(\"getty\", renderGetty);\n    onReady(convertGettyEmbeds);\n    onContent(convertGettyEmbeds);\n}\n\n/**\n * Render a single getty embed.\n */\nexport async function renderGetty(elements: IEmbedElements, data: IScrapeData) {\n    const contentElement = elements.content;\n    const url = data.attributes.post;\n    const newLink = document.createElement(\"a\");\n    newLink.classList.add(\"gie-single\");\n    newLink.setAttribute(\"href\", \"http://www.gettyimages.ca/detail/\" + url);\n    newLink.setAttribute(\"id\", data.attributes.id);\n    contentElement.style.width = `${data.width}px`;\n    contentElement.appendChild(newLink);\n    setImmediate(() => {\n        void loadGettyImages(data);\n    });\n}\n\n/**\n * Renders posted getty embeds.\n */\nexport async function convertGettyEmbeds() {\n    const gettyPosts = document.querySelectorAll(\".js-gettyEmbed\");\n    if (gettyPosts.length > 0) {\n        for (const post of gettyPosts) {\n            const url = post.getAttribute(\"href\") || \"\";\n            const id = post.getAttribute(\"id\");\n            const sig = post.getAttribute(\"data-sig\");\n            const height = Number(post.getAttribute(\"data-height\")) || 1;\n            const width = Number(post.getAttribute(\"data-width\")) || 1;\n            const items = post.getAttribute(\"data-items\");\n            const capt = post.getAttribute(\"data-capt\");\n            const tld = post.getAttribute(\"data-tld\");\n            const i360 = post.getAttribute(\"data-is360\");\n            const data: IEmbedData = {\n                type: \"getty\",\n                url,\n                height,\n                width,\n                attributes: { id, sig, items, capt, tld, i360 },\n            };\n            await loadGettyImages(data);\n            post.classList.remove(\"js-gettyEmbed\");\n        }\n    }\n}\n\n/**\n * Loads getty embeds into a global object and fire getty's widget.js.\n * @param data\n * @returns {Promise<void>}\n */\nasync function loadGettyImages(data) {\n    const fallbackCallback = c => {\n        (window.gie.q = window.gie.q || []).push(c);\n    };\n    // This is part of Getty's embed code, we need to ensure embeds are loaded and sent to their widget.js script.\n    window.gie = window.gie || fallbackCallback;\n\n    window.gie(() => {\n        window.gie.widgets.load({\n            id: data.attributes.id,\n            sig: data.attributes.sig,\n            w: data.width + \"px\",\n            h: data.height + \"px\",\n            items: data.attributes.items,\n            caption: data.attributes.isCaptioned,\n            tld: data.attributes.tld,\n            is360: data.attributes.is360,\n        });\n    });\n\n    /// DO NOT IGNORE\n    /// This will turn totally sideways if window.gie is not populated before the script is initially loaded.\n    await ensureScript(\"//embed-cdn.gettyimages.com/widgets.js\");\n}\n"],"sourceRoot":""}